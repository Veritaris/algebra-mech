\section{Жорданова нормальная форма}\label{subsect:jordan_form}

Пусть $U,V$~--- конечномерные пространства над $k$.
В прошлой главе мы выяснили, что для линейного отображения $T\colon
U\to V$ можно выбрать базисы в $U$ и в $V$ так, что матрица $\ph$ в
этих базисах будет окаймленной единичной.
Пусть теперь $T\colon V\to V$~--- линейное отображение из
пространства в себя. Мы будем называть его \dfn{линейным
  оператором}\index{оператор!линейный} (или
просто \dfn{оператором}\index{оператор}) на $V$.
Не очень-то удобно выбирать два разных базиса в
одном и том же пространстве $V$ для записи матрицы линейного
оператора. Пусть $\mc B$~--- базис пространства $V$.
\dfn{Матрицей оператора}\index{матрица!оператора} $T\colon V\to V$ в
базисе $\mc B$ называется
матрица отображения $T$ в базисах $\mc B$, $\mc B$.
Мы будем обозначать ее через $[T]_{\mc B}$ вместо $[T]_{\mc B,\mc B}$.
Цель настоящей главы~--- выяснить, к какому наиболее простому виду
можно привести матрицу
оператора $T$ с помощью выбора базиса в $V$.
По теореме~\ref{thm_matrix_under_change_of_bases} при замене базиса
$\mc B$ на $\mc B'$ матрица оператора $T$ домножается справа на матрицу
замены базиса и слева на обратную к ней. Таким образом, если
$A=[T]_{\mc B}$, $A'=[T]_{\mc B'}$, $C$~--- матрица перехода от $\mc
B$ к $\mc B'$, то $A'=C^{-1}AC$. Эта процедура называется
\dfn{сопряжением}\index{сопряжение!матрицы}: говорят, что
$C^{-1}AC$~--- матрица, \dfn{сопряженная} к матрице $A$ при помощи
$C$.

В этой главе нас будет интересовать вопрос: к какому хорошему виду
можно привести матрицу произвольного линейного оператора? В отличие от
случая линейного отображения, рассчитывать на окаймленный единичный
вид уже не приходится. Тем не менее, мы получим достаточно разумный
ответ на этот вопрос. Можно сформулировать эту задачу на матричном
языке: в прошлой главе мы видели, что с помощью домножения слева и
справа на обратимые матрицы любую матрицу можно привести к окаймленной
единичной форме; а к какому виду можно привести квадратную матрицу с
помощью сопряжения?

Мы будем предполагать в этой главе, что все встречающиеся нам
векторные пространства конечномерны.

\subsection{Инвариантные подпространства и собственные числа}

\literature{[F], гл. XII, \S~6, п. 1; гл. IV, \S~6, п. 1; [K2], гл. 2,
\S~3, п. 3; [KM], ч. 1, \S~8; [vdW], гл. XII, \S~88.}

Первая идея для изучения операторов на пространстве состоит
в следующем: можно попытаться посмотреть на то, что происходит
в собственном подпространстве $U$ оператора $V$, решить вопрос для него
(что проще, поскольку размерность $U$ меньше размерности $V$),
а потом попробовать <<подняться>> в пространство $V$.
Пусть $T\colon V\to V$~--- линейный оператор, $U\leq V$~--- некоторое
подпространство. Проблема состоит в том, что ограничение
$T|_U$ действует из $U$ в $V$ и уже не является линейным оператором!
Опишем подпространства, для которых такого не происходит.
\begin{definition}
Пусть $T\colon V\to V$~--- линейный оператор на пространстве $V$.
Подпространство $U\leq V$ называется \dfn{инвариантным} относительно
оператора $T$ (или \dfn{$T$-инвариантным}), если
$T(U)\subseteq U$. Иными словами: для любого $u\in U$ образ
$T(u)$ также лежит в $U$.
\end{definition}

\begin{example}
Можно привести тривиальные примеры: подпространства $0\leq V$
и $V\leq V$ инвариантны относительно любого линейного оператора
на $V$.
\end{example}

Самый простой пример инвариантного подпространства возникают, когда
это подпространство одномерно. Тогда $U$ порождается одним ненулевым
вектором $u\in U$, и для $T$-инвариантности $U$ достаточно потребовать,
чтобы образ $T(u)$ лежал в $U$, то есть, имел вид $u\lambda$ для
некоторого $\lambda\in k$
\begin{definition}
Пусть $T\colon V\to V$~--- линейный оператор.
Скаляр $\lambda\in k$ называется \dfn{собственным числом} оператора
$T$, если существует ненулевой вектор $u\in V$ такой, что
$T(u) = u\lambda$. В этом случае $u$ называется
\dfn{собственным вектором} оператора $T$ (соответствующим
собственному числу $\lambda$).
\end{definition}
Полезны следующие эквивалентные переформулировки понятия
собственного числа.
\begin{proposition}\label{prop:eigenvalue-alternative-defs}
Пусть $T\colon V\to V$~--- линейный оператор, $\lambda\in k$.
Следующие утверждения равносильны:
\begin{enumerate}
\item $\lambda$~--- собственное число оператора $T$;
\item оператор $T-\lambda\id_V$ неинъективен;
\item оператор $T-\lambda\id_V$ несюръективен;
\item оператор $T-\lambda\id_V$ необратим.
\end{enumerate}
\end{proposition}
\begin{proof}
Если $\lambda$~--- собственное число $T$, то $(T-\id_V\lambda)(u)=0$
для некоторого ненулевого $u\in V$, и потому $T-\id_V\lambda$
неинъективен. Обратно, неинъективность $T-\id_V\lambda$ означает,
что $\Ker(T-\id_V\lambda)\neq 0$, и если $u$~--- ненулевой вектор из
этого ядра, то $T(u) = u\lambda$, что и означает, что $\lambda$~---
собственное число $T$.
Равносильность утверждений (2), (3), (4) сразу следует из
предложения~\ref{prop:operators-bij-inj-surj}.
\end{proof}
Таким образом, собственные числа оператора $T$~--- это в точности
те скаляры $\lambda$, для которых оператор $T-\id_V\lambda$
имеет нетривиальное ядро, а соответствующие собственные векторы~---
это в точности ненулевые элементы этого ядра.

\begin{theorem}\label{thm:eigenvectors-are-independent}
Пусть $T\colon V\to V$~--- линейный оператор,
$v_1,\dots,v_n\in V$~--- собственные векторы, соответствующие
попарно различным собственным числам $\lambda_1,\dots,\lambda_n\in k$.
Тогда векторы $v_1,\dots,v_n$ линейно независимы.
\end{theorem}
\begin{proof}
Будем доказывать от противного: пусть $v_1,\dots,v_n$ линейно зависиым.
По лемме~\ref{lemma:linear-dependence-lemma} найдется индекс
$j$ такой, что $v_j$ выражается через $v_1,\dots,v_{j-1}$.
Выберем наименьший из таких индексов $j$ и запишем полученную
линейную зависимость:
$$
v_j = v_1a_1 + \dots + v_{j-1}a_{j-1}.
$$
Применим оператор $T$ к обеим частям этого равенства:
$$
T(v_j) = T(v_1)a_1 + \dots + T(v_{j-1})a_{j-1}.
$$
Мы знаем, что $T(v_i) = v_i\lambda_i$ для всех $i=1,\dots,n$, потому
$$
v_j\lambda_j = v_1\lambda_1a_1 + \dots + v_{j-1}\lambda_{j-1}a_{j-1}.
$$
С другой стороны, мы можем умножить исходную линейную зависимость
на $\lambda_j$:
$$
v_j\lambda_j = v_1\lambda_j a_1 + \dots + v_{j-1}\lambda_j a_{j-1}.
$$
Вычтем два последних равенства:
$$
0 = v_1(\lambda_1-\lambda_j)a_1 + \dots +
v_{j-1}(\lambda_{j-1}-\lambda_j)a_{j-1}.
$$
В силу нашего выбора $j$ векторы $v_1,\dots,v_{j-1}$ линейно независимы.
Поэтому в полученном выражении все коэффициенты
$(\lambda_i-\lambda_j)a_i$ должны быть нулевыми. Но скаляры
$\lambda_i$ попарно различны, потому $\lambda_j-\lambda_j\neq 0$
при всех $i=1,\dots,j-1$. Значит, $a_i=0$ для $i=1,\dots,j-1$. Подставляя
в исходную линейную комбинацию, получаем, что $v_j=0$,
что противоречит определению собственного вектора.
\end{proof}

\begin{corollary}
Количество различных собственных чисел оператора на пространстве $V$
не превосходит $\dim(V)$.
\end{corollary}
\begin{proof}
Если нашлось больше, чем $\dim(V)$, различных собственных чисел,
то соответствующие им собственные векторы линейно независимы
по теореме~\ref{thm:eigenvectors-are-independent}, а это
противоречит теореме~\ref{thm:independent-set-smaller-than-generating}.
\end{proof}

Возвращаясь к общему понятию инвариантного подпространства, мы теперь
можем уточнить, в каком смысле наличие инвариантных подпространств
помогает свести изучение оператора на пространстве к изучению
операторов на меньших пространствах.
\begin{definition}
Пусть $T\colon V\to V$~--- линейный оператор, $U\leq V$~---
$T$-инвариантное подпространство.
Отображение $T|_U\colon U\to U$, заданное формулой
$(T|_U)(u) = T(u)$, называется \dfn{ограничением линейного оператора}
на инвариантное подпространство $U$.
Отображение $T_{V/U}\colon V/U\to V/U$, заданное формулой
$T_{V/U}(v+U) = T(v) + U$, называется \dfn{индуцированным оператором}
на фактор-пространстве $V/U$.
\end{definition}
\begin{proposition}
Ограничение на инвариантное подпространство и индуцированный оператор
на фактор-пространстве корректно определены и являются линейными
операторами.
\end{proposition}
\begin{proof}
В силу инвариантности $U$ элемент $T(u)$ лежит в $U$ для всех $u\in U$,
поэтому формула $(T|_U)(u) = T(u)$ задает
отображение $T|_U\colon U\to U$. Его линейность очевидным образом
следует из линейности $T$.

Для индуцированного отображения на фактор-пространстве сначала нужно
проверить его корректность, то есть, то, что
правило $v+U \mapsto T(v) + U$ не зависит от выбора представителей.
Пусть $v'$~--- другой представитель класса $v+U$, то есть,
$v' = v + u$ для некоторого $u\in U$.
Тогда $T(v') = T(v) + T(u)$. В силу $T$-инвариантности подпространства
$U$ вектор $T(u)$ лежит в $U$. Значит, $T(v')$ и $T(v)$ отличаются
на элемент из $U$, а потому лежат в одном классе по модулю $U$.

После этого линейность отображения $T_{V/U}$ также напрямую следует
из линейности оператора $T$.
\end{proof}

\subsection{Собственные числа оператора над алгебраически замкнутым полем}

Напомним, что линейные операторы на пространстве $V$ образуют кольцо
относительно сложения и композиции (а композицию мы часто записываем
как умножение; в кольце матриц она буквально соответствует
умножению матриц). Поэтому не очень удивительно,
что мы можем рассматривать многочлены от оператора $T$ на $V$.
А именно, пусть $T\colon V\to V$~--- линейный оператор на
векторном пространстве $V$ над $k$, и пусть $f\in k[x]$~--- некоторый
многочлен с коэффициентами в том же поле $k$.
Запишем $f = a_0 + a_1x + a_2x^2 + \dots + a_{n}x^n$.
Определим \dfn{результат подстановки оператора $T$ в многочлен $f$}
следующим образом:
$$
f(T) = \id_V a_0 + Ta_1 + T^2a_2 + \dots + T^n a_n.
$$
Здесь $T^n = \underbrace{T\circ\dots\circ T}_{n}$~--- результат
$n$-кратной композиции $T$ с собой. Нетрудно проверить, что это
<<возведение в степень>> определено для всех натуральных $n$
и обладает обычными свойствами, например, что $T^{m+n} = T^m\circ T^n$.

Итак, мы получили новый линейный оператор $f(T)$ по каждому многочлену
$f\in k[x]$ и оператору $T$ на $V$.
Эта операция напоминает <<подстановку скаляра в многочлен>>
(оно же <<вычисление значение многочлена в точке>>,
см. определение~\ref{dfn:poly-value}), и обладает
похожими свойствами (см. предложение~\ref{prop:evaluation-properties}):
если $f,g\in k[x]$, $\lambda\in k$, $T$~--- оператор на $V$,
то $(f+g)(T) = f(T) + g(T)$, $(fg)(T) = f(T)g(T)$,
$(f\lambda)(T) = f(T)\lambda$.
Эти свойства проверяются простым раскрытием скобок. Действительно,
пусть $f = a_0 + a_1x + \dots + a_mx^m$, 
$g = b_0 + b_1x + \dots + b_nx^n$.
Тогда $fg = \sum_k\left(\sum_{i+j=k}a_ib_j\right)x^k$.
Подставляя оператор $T$, получаем
$f(T) = \id_V a_0 + Ta_1 + \dots + T^m a_m$,
$g(T) = \id_V b_0 + Tb_1 + \dots + T^n b_n$,
и потому
$f(T)g(T) = \sum_k\left(\sum_{i+j=k}T^i a_i T^j b_j\right)
= \sum_k T_i\left(\sum_{i+j=k}a_i b_j\right)
= (fg)(T)$. Остальные свойства проверяются аналогично.

В частности, $f(T)g(T) = g(T)f(T)$: {\em многочлены от одного
оператора коммутируют между собой} (обратите внимание, что
композиция операторов, вообще говоря, некоммутативна:
$ST\neq TS$).

\begin{proposition}\label{prop:operator-has-an-eigenvalue}
Пусть поле $k$ алгебраически замкнуто, $V\neq 0$~---
векторное пространство над $k$, $T\colon V\to V$~---
линейный оператор на $V$.
Тогда у $T$ есть собственное число.
\end{proposition}
\begin{proof}
Выберем произвольный ненулевой вектор $v\in V$.
Пусть $\dim V = n$. Рассмотрим векторы
$v,T(v),T^2(v),\dots,T^n(v)$.
Это $n+1$ вектор в $n$-мерном векторном пространстве,
и потому они линейно зависимы.
По лемме~\ref{lemma:linear-dependence-lemma} найдется индекс
$j>0$ такой, что $T^j(v)$ выражается через векторы вида
$T^i(v)$ для $i<j$. Запишем это выражение:
$v a_0 + T(v) a_1 + \dots + T^{j-1}(v) a_{j-1} = T^j(v)$.
Перенесем все в одну часть и вынесем $v$:
$$
(T^j - T^{j-1}a_{j-1} - \dots - T a_1 - \id_V a_0)(v) = 0.
$$
В скобках стоит многочлен от оператора $T$, а именно, $f(T)$,
где $f(x) = x^j - a_{j-1}x^{j-1} - \dots - a_1x - a_0$.
Наше поле алгебраически замкнуто, а степень $f$ больше нуля,
потому $f$ раскладывается на линейные множители:
$f(x) = (x - \lambda_1)\dots(x-\lambda_j)$, и, стало быть,
$f(T) = (T - \id_V\lambda_1)\dots(T-\id_V\lambda_j)$.

Итак, мы получили, что $f(T)(v) = 0$, то есть, что
$(T-\id_V\lambda_1)\dots (T-\id_V\lambda_j)(v) = 0$.
Происходит следующее: на ненулевой вектор $v$ действуют по очереди
операторы вида $T - \id_V\lambda_i$, и получается $0$. Из этого
следует, что хотя бы один из них неинъективен~--- иначе из ненулевого
вектора на каждом шаге получался бы ненулевой.
Но неинъективность оператора $T - \id_V\lambda_i$ как раз и означает,
что $\lambda_i$ является собственным числом $T$
(предложение~\ref{prop:eigenvalue-alternative-defs}).
\end{proof}

Итак, в случае алгебраически замкнутого поля, у каждого оператора
$T$ есть хотя бы одно собственное число $\lambda$, и, разумеется,
есть соответствующий этому числу [ненулевой] собственный вектор $v$.
Дополним этот вектор до некоторого базиса
$\mc B = \{v, v_2,\dots,v_n\}$.
Матрица оператора $T$ в этом базисе выглядит следующим образом:
$$
\begin{pmatrix}
\lambda & * & \dots & * \\
0 & * \dots & * \\
\vdots & \vdots & \ddots & \vdots \\
0 & * & \dots & *
\end{pmatrix}.
$$
Мы совершили небольшое продвижение к нашей цели: мы нашли базис,
в котором матрица нашего оператора выглядит чуть-чуть лучше, чем наугад
взятая матрица, а именно, в ней появилось несколько нулей.
Оказывается, мы можем продолжить этот процесс по индукции, и
найти базис, в котором матрица нашего оператора верхнетреугольна.
Для этого нам понадобится следующее описание верхнетреугольных матриц.
\begin{proposition}\label{prop:ut-equivalent-defs}
Пусть $T\colon V\to V$~--- линейный оператор,
$\mc B = \{v_1,\dots,v_n\}$~--- некоторый базис пространства $V$.
Следующие утверждения равносильны:
\begin{enumerate}
\item матрица $[T]_{\mc B}$ верхнетреугольна;
\item для всех $j=1,\dots,n$ вектор $T(v_j)$ лежит в
$\la v_1,\dots,v_j\ra$;
\item для всех $j=1,\dots,n$ подпространство
$\la v_1,\dots,v_j\ra$ является $T$-инвариантным.
\end{enumerate}
\end{proposition}
\begin{proof}
Предположим, что матрица $[T]_{\mc B}$ верхнетреугольна. Посмотрим
на ее $j$-й столбец: в нем стоит разложение вектора $T(v_j)$
по базису $\mc B$. То, что ниже диагонали там стоят нули, означает,
что $T(v_j)$ на самом деле выражается только через векторы
$v_1,\dots,v_j$. Обратно, если $T(v_j)$ выражается только через
$v_1,\dots,v_j$, то в $j$-м столбце ниже диагонального элемента
должны стоять нули. Поэтому первые два условия равносильны.

Очевидно, что из третьего условия следует второе. Осталось лишь
показать, что из второго следует третье. Итак, пусть выполняется
(2). Тогда
\begin{align*}
T(v_1)&\in\la v_1\ra \subseteq\la v_1,\dots,v_j\ra,\\
T(v_2)&\in\la v_1,v_2\ra \subseteq\la v_1,\dots,v_j\ra,\\
\vdots& \\
T(v_j)&\in\la v_1,\dots,v_j\ra.
\end{align*}
Если $v$~--- любая линейная комбинация векторов $v_1,\dots,v_j$,
то $T(v)$ является линейной комбинацией векторов $T(v_1),\dots,T(v_j)$,
и потому лежит в $\la v_1,\dots,v_j\ra$. Это означает, что
подпространство $\la v_1,\dots,v_j\ra$ является $T$-инвариантным.
\end{proof}

\begin{theorem}
Пусть $k$~--- алгебраически замкнутое поле, $T\colon V\to V$~---
линейный оператор на конечномерном
векторном пространстве $V$ над полем $k$.
Тогда существует базис $v_1,\dots,v_n$ пространства $V$,
в котором матрица оператора $T$ имеет верхнетреугольный вид.
\end{theorem}
\begin{proof}
Пусть $\dim(V) = n$; будем доказывать теорему индукцией по $n$.
Случай $n=1$ очевиден; пусть теперь $n>1$. По
предложению~\ref{prop:operator-has-an-eigenvalue} у $T$ есть собственное
число $\lambda$. Обозначим $U = \Img(T-\id_V\lambda)\leq V$.
По предложению~\ref{prop:eigenvalue-alternative-defs} оператор
$T-\id_V\lambda$ не сюръективен, и потому $U\neq V$.
Покажем, что подпространство $U$ является $T$-инвариантным.
Действительно, для любого $u\in U$ выполнено
$T(u) = (T-\id_V\lambda)(u) + u\lambda$, и очевидно, что оба слагаемых
лежат в $U$.

Теперь мы можем рассмотреть ограничение $T|_U$ оператора $T$ на
подпространство $U$. Мы знаем, что $\dim(U) < \dim(V)$, и потому
к $U$ можно применить предположение индукции и заключить, что
существует базис $u_1,\dots,u_m$ пространства $U$, в котором
матрица оператора $T|_U$ верхнетреугольна. По
предложению~\ref{prop:ut-equivalent-defs} из этого следует, что
$T(u_j) = (T|_U)(u_j) \in\la u_1,\dots,u_j\ra$ для всех $j=1,\dots,m$.

Дополним $u_1,\dots,u_m$ до базиса $u_1,\dots,u_m,v_1,\dots,v_s$
пространства $V$. Тогда
$T(v_k) = (T-\id_V\lambda)v_k + v_k\lambda$ для всех $k=1,\dots,s$.
По определению $(T-\id_V\lambda)v_k\in U$, и потому
$T(v_k)\in\la u_1,\dots,u_m,v_1,\dots,v_k\ra$.
По предложению~\ref{prop:ut-equivalent-defs} из этого следует,
что матрица оператора $T$ в базисе
$u_1,\dots,u_m,v_1,\dots,v_s$ верхнетреугольна.
\end{proof}

% 27.04.2015

Зная базис, в котором матрица оператора верхнетреугольна, легко
определить, когда этот оператор обратим.
\begin{proposition}\label{prop:when-ut-is-invertible}
Пусть матрица оператора $T\colon V\to V$ в некотором базисе
верхнетреугольна. Оператора $T$ обратим тогда и только тогда,
когда все диагональные элементы этой матрицы отличны от нуля.
\end{proposition}
\begin{proof}
Пусть $\mc B = (v_1,\dots,v_n)$~--- базис, в котором матрица
оператора $T$ верхнетреугольна, и пусть
$$[T]_{\mc B} = \begin{pmatrix}
\lambda_1 & * & \dots & * \\
0 & \lambda_2 & \dots & * \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & \lambda_n
\end{pmatrix}.
$$

Предположим, что оператор $T$ обратим. Тогда $\lambda_1\neq 0$
(иначе $T(v_1) = v_1\lambda_1 = 0$). Предположим, что
$\lambda_j = 0$ для некоторого $j>1$. Глядя на матрицу $T$,
мы видим, что $T$ отображает подпространство
$\la v_1,\dots,v_j\ra$ в подпространство $\la v_1,\dots,v_{j-1}\ra$.
При этом размерность первого подпространства равна $j$,
а второго~--- $j-1$. По следствию~\ref{cor:no-injective-maps}
не существует инъективных линейных отображений из $j$-мерного
пространства в $(j-1)$-мерное. Значит, ограничение оператора $T$
на подпространство $\la v_1,\dots,v_j\ra$ неинъективно.
Это означает, что найдется ненулевой вектор $v\in\la v_1,\dots,v_j\ra$,
для которого $T(v) = 0$. Поэтому $T$ неинъективен, что противоречит
предположению об обратимости $T$.

Обратно, предположим теперь, что все $\lambda_1,\dots,\lambda_n$
отличны от нуля. Глядя на первый столбец матрицы оператора
$T$, мы видим, что $T(v_1) = v_1\lambda_1$,
и потому $T(v_1\lambda_1^{-1}) = v_1$. Значит, $v_1\in\Img(T)$.
Далее, судя по второму столбцу матрицы оператора $T$,
$T(v_2\lambda_2^{-1}) = v_1 a + v_2$ для некоторого $a\in k$.
При этом $T(v_2\lambda_2^{-1})$ и $v_1a$ лежат в $\Img(T)$.
Поэтому и $v_2\in\Img(T)$.
Аналогично,
$T(v_3\lambda_3^{-1}) = v_1b + v_2c + v_3$ для некоторых
$b,c\in k$. Мы уже знаем, что все члены этого равенства, кроме $v_3$,
лежат в $\Img(T)$, потому и $v_3\in\Img(T)$.

Продолжая аналогичным образом, мы получаем, что
$v_1,\dots,v_n\in\Img(T)$.
Тогда и $\la v_1,\dots,v_n\ra\subseteq\Img(T)$. Но $v_1,\dots,v_n$~---
базис пространства $V$, и потому
$\Img(T) = V$. Значит, оператор $T$ сюръективен, что по
предложению~\ref{prop:operators-bij-inj-surj} влечет его обратимость.
\end{proof}

Теперь несложно показать, что если мы смогли привести матрицу
оператора к верхнетреугольному виду, то на диагонали в точности стоят
собственные числа этого оператора.
\begin{proposition}
Пусть матрица оператора $T$ относительно некоторого базиса
верхнетреугольна. Тогда собственные числа оператора $T$~--- это
в точности диагональные элементы этой матрицы.
\end{proposition}
\begin{proof}
Пусть
$$
[T]_{\mc B} = \begin{pmatrix}
\lambda_1 & * & \dots & * \\
0 & \lambda_2 & \dots & * \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & \lambda_n
\end{pmatrix}.
$$
Для $\lambda\in k$ рассмотрим оператор $\lambda - \id_V\lambda$.
Его матрица в том же базисе имеет вид
$$
[T -\id_V\lambda]_{\mc B} = \begin{pmatrix}
\lambda_1-\lambda & * & \dots & * \\
0 & \lambda_2-\lambda & \dots & * \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & \lambda_n-\lambda
\end{pmatrix}.
$$
По предложению~\ref{prop:when-ut-is-invertible} обратимость
оператора $T-\id_V\lambda$ равносильна тому, что $\lambda_j-\lambda=0$
для некоторого $j$, то есть, что $\lambda$ стоит на диагонали.
С другой стороны, по предложению~\ref{prop:eigenvalue-alternative-defs}
обратимость оператора $T-\id_V\lambda$ равносильна тому, что
$\lambda$~--- собственное число оператора $T$.
\end{proof}

\begin{definition}
Пусть $T\colon V\to V$~--- линейный оператор на векторном пространстве
$V$, $\lambda\in k$. Подпространство
$V_\lambda(T) = \Ker(T-\id_V\lambda)$ в $V$ называется
\dfn{собственным подпространством} оператора $T$, соответствующим
числу $\lambda$. Часто, если понятно, о каком операторе идет речь,
мы опускаем $T$ в обозначении и пишем $V_\lambda$ вместо $V_\lambda(T)$.
\end{definition}

Нетрудно видеть, что $V_\lambda$~--- это в точности множество
всех собственных векторов оператора $T$, соответствующих $\lambda$,
вместе с $0$. Скаляр $\lambda$ является собственным числом
оператора $T$ тогда и только тогда, когда подпространство
$V_\lambda$ отлично от нулевого.

\begin{proposition}\label{prop:sum-of-eigenspaces-is-direct}
Пусть $V$~--- конечномерное пространство над полем $k$,
$T\colon V\to V$~--- линейный оператор. Пусть
$\lambda_1,\dots,\lambda_m$~--- различные собственные числа
оператора $T$.
Тогда сумма $V_{\lambda_1} + \dots + V_{\lambda_m}$ прямая.
Кроме того, $\dim V_{\lambda_1} + \dots + \dim V_{\lambda_m}\leq
\dim V$.
\end{proposition}
\begin{proof}
Пусть $u_1 + \dots + u_m = 0$, где $u_j\in V_{\lambda_j}$
Из линейной независимости собственных векторов
(теорема~\ref{thm:eigenvectors-are-independent})
следует, что $u_1 = \dots = u_m = 0$. Поэтому сумма
$V_{\lambda_1} + \dots + V_{\lambda_m}$ прямая.
Утверждение про размерность теперь напрямую следует из того,
что размерность прямой суммы подпространств равна сумме
их размерностей (следствие~\ref{cor:direct-sum-dimension}).
\end{proof}


\subsection{Диагонализуемые операторы}\label{subsect:diagonalizable}

\literature{[K2], гл. 2, \S~3, п. 4; [KM], ч. 1, \S~8.}

\begin{definition}
Оператор $T\colon V\to V$ называется \dfn{диагонализуемым},
если его матрица относительно некоторого базиса пространства $V$
диагональна.
\end{definition}
Диагонализуемые операторы составляют важный класс операторов,
для которых задача приведения к <<наиболее удобной форме>>
решается просто (нет ничего удобнее диагональной матрицы).
Поэтому полезно уметь распознавать их.
\begin{theorem}\label{thm:diagonalizable-equivalent}
Пусть $V$~--- конечномерное векторное пространство,
$T\colon V\to V$~--- линейный оператор. Пусть
$\lambda_1,\dots,\lambda_m$~--- все различные собственные числа
оператора $T$. Следующие условия эквивалентны:
\begin{enumerate}
\item оператор $T$ диагонализуем;\label{thm:diagonalizable-equivalent-1}
\item у пространства $V$ есть базис, состоящий из собственных
векторов оператора $T$;\label{thm:diagonalizable-equivalent-2}
\item найдутся одномерные подпространства $U_1,\dots,U_n$ в $V$,
каждое из которых $T$-инвариантно, такие, что
$V = U_1\oplus\dots\oplus U_n$;\label{thm:diagonalizable-equivalent-3}
\item $V = V_{\lambda_1}(T)\oplus\dots\oplus V_{\lambda_m}(T)$;
\label{thm:diagonalizable-equivalent-4}
\item $\dim V = \dim V_{\lambda_1}(T) + \dots + \dim V_{\lambda_m}(T)$.
\label{thm:diagonalizable-equivalent-5}
\end{enumerate}
\end{theorem}
\begin{proof}
\begin{itemize}
\item $1\Leftrightarrow 2$.
Заметим, что матрица оператора $T$ в базисе $v_1,\dots v_n$
имеет вид
$$
\begin{pmatrix}
\lambda_1 & 0 & \dots & 0 \\
0 & \lambda_2 & \dots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & \lambda_n
\end{pmatrix}
$$
тогда и только тогда, когда $T(v_j) = v_j\lambda_j$
для всех $j=1,\dots,n$.
\item $2\Rightarrow 3$. Предположим, что $v_1,\dots,v_n$~--- базис $V$,
и каждый вектор $v_j$~--- собственный вектор оператора $T$.
Обозначим $U_j = \la v_j\ra$. Очевидно, что каждое подпространство
$U_j$ одномерно и $T$-инвариантно. Из определения базиса
следует, что вектор из $V$ можно
единственным образом записать в виде линейной комбинации элементов
$v_1,\dots,v_n$. Иными словами любой вектор из $V$ можно единственным
образом представить в виде суммы $u_1+\dots+u_n$, где $u_j\in U_j$.
Это и значит, что $V = U_1\oplus \dots \oplus U_n$.
\item $3\Rightarrow 2$. Пусть $V=U_1\oplus\dots\oplus U_n$
для некоторых одномерных $T$-инвариантных подпространств
$U_1,\dots,U_n$. Выберем в каждом $U_j$ по ненулевому вектору
$v_j$. Из $T$-инвариантности $U_j$ следует, что $v_j$~--- собственный
вектор оператора $T$. Каждый вектор из $V$ можно единственным образом
представить в виде суммы $u_1+\dots+u_n$, где $u_j\in U_j$, то есть,
единственным образом представить в виде суммы кратных $v_j$.
Поэтому $v_1,\dots,v_n$~--- базис $V$.
\item $2\Rightarrow 4$. Пусть у $V$ есть базис, состоящий из
собственных векторов. Тогда любой вектор $V$ является линейной
комбинацией собственных, и потому
$V = V_{\lambda_1}(T) + \dots + V_{\lambda_m}(T)$.
Осталось применить предложение~\ref{prop:sum-of-eigenspaces-is-direct}.
\item $4\Rightarrow 5$. Достаточно применить
следствие~\ref{cor:direct-sum-dimension}.
\item $5\Rightarrow 2$. Выберем базис в каждом подпространстве
$V_{\lambda_j}(T)$. Собрав эти базисы вместе, получим
набор $v_1,\dots,v_n$, состоящий из собственных векторов
оператора $T$. По предположению их количество $n$ равно $\dim V$.
Покажем, что этот набор линейно независим. Предположим, что
$v_1a_1 + \dots + v_na_n = 0$ для некоторых $a_1,\dots,a_n\in k$.
Пусть $u_j$~--- сумма всех слагаемых вида $v_ka_k$, для которых
$v_k\in V_{\lambda_j}$. Тогда каждый вектор $u_j$ лежит
в $V_{\lambda_j}$, и сумма $u_1+\dots+u_m = 0$.
Из теоремы~\ref{thm:eigenvectors-are-independent} следует,
что все слагаемые этой суммы равны нулю. Но каждое слагаемое
$u_j$ является суммой элементов вида $v_ka_k$, где $v_k$ образуют
базис пространства $V_{\lambda_j}$. Поэтому все коэффициенты
$a_k$ равны нулю. Мы получили, что набор $v_1,\dots,v_n$ линейно
независим. Его можно дополнить до базиса, но, с другой стороны,
количество векторов в этом наборе уже равно размерности
пространства $V$. Поэтому $v_1,\dots,v_n$~--- базис $V$.
\end{itemize}
\end{proof}

\begin{example}
Пусть оператор $T$ на двумерном пространстве $k^2$ задан формулой
$v\mapsto A\cdot v$, где
$$
A = \begin{pmatrix} 0 & 1 \\ 0 & 0\end{pmatrix}.
$$
Иными словами, $A$~--- матрица оператора $T$ в стандартном
базисе пространства $k^2$.
Матрица $A$ верхнетреугольна, поэтому собственные числа оператора
$T$~--- это ее диагональные элементы. Таким образом, у $T$
есть ровно одно собственное число: $0$. Несложное вычисление показывает,
что все собственные векторы имеют вид $\begin{pmatrix} * \\ 0\end{pmatrix}$. Поэтому у $k^2$ нет базиса, состоящего из собственных
векторов, а значит, оператор $T$ не диагонализуем.
\end{example}

Таким образом, не любой оператор можно привести к диагональному виду.
Но, во всяком случае, это возможно, если у оператора достаточно
много различных собственных чисел.
\begin{corollary}
Пусть $T\colon V\to V$~--- линейный оператор на $n$-мерном векторном
пространстве $V$. Предположим, что у $T$ есть $n$ различных
собственных чисел. Тогда оператор $T$ диагонализуем.
\end{corollary}
\begin{proof}
У оператора $T$ есть $n$ собственных векторов $v_1,\dots,v_n$,
соответствующих различным собственным числам.
По теореме~\ref{thm:eigenvectors-are-independent} они
линейно независимы. Но их количество равно размерности пространства
$V$, и потому они образуют базис $V$. По
теореме~\ref{thm:diagonalizable-equivalent}
из этого следует, что $T$ диагонализуем.
\end{proof}

\subsection{Корневое разложение}

\literature{[F], гл. XII, \S~6, п. 2; [K2], гл. 2, \S~4, п. 3; [KM], ч. 1, \S~9.}


Для нахождения правильного базиса в пространстве $V$ нам понадобится
некоторое расширение понятия собственного вектора.
Напомним, что собственные векторы~--- это в точности ненулевые
элементы $\Ker(T-\id_V\lambda)$. Посмотрим теперь
на $\Ker(T-\id_V\lambda)^j$ при различных $j=1,2,\dots$.
\begin{lemma}\label{lemma:series-of-kernels}
Для любого оператора $T\colon V\to V$ имеется
возрастающая цепочка вложенных подпространств
$$
0 = \Ker(T^0) \leq \Ker(T) \leq \Ker(T^2) \leq \Ker(T^3) \leq \dots.
$$
Более того, если $\Ker(T^j) = \Ker(T^{j+1})$ для некоторого
натурального $j$, то $\Ker(T^{j+m})=\Ker(T^{j+m+1})$ для всех $m\geq0$.
\end{lemma}
\begin{proof}
Пусть $v\in\Ker(T^i)$. Это значит, что $T^i(v)=0$.
Но тогда и $T^{i+1}(v)=T(T^i(v)) = T(0)=0$.
Мы показали, что $\Ker(T^i)\subseteq\Ker(T^{i+1})$.
Докажем второе утверждение индукцией по $m$. База $m=0$ очевидна.
Пусть теперь $m>0$. Мы уже знаем, что $\Ker(T^{j+m})\subseteq
\Ker(T^{j+m+1})$; осталось доказать обратное включение.
Пусть $v\in\Ker(T^{j+m+1})$. Это означает, что
$T^{j+m+1}(v)=0$. Но $T^{j+m+1}(v) = T^{j+1}(T^m(v)) = 0$.
Поэтому $T^m(v)\in\Ker(T^{j+1}) = \Ker(T^j)$,
и тогда $0 = T^j(T^m(v)) = T^{j+m}(v)$, что и требовалось.
\end{proof}

Итак, мы построили бесконечную цепочку возрастающих подпространств
и показали, что если два элемента в ней совпали, то начиная
с этого места цепочка <<стабилизируется>>.
В конечномерном пространстве $V$, разумеется, невозможна
бесконечная цепочка {\em строго} возрастающих подпространств.
\begin{proposition}\label{prop:nilpotence-degree-is-bounded}
Пусть $T\colon V\to V$~--- линейный оператор на конечномерном
пространстве $V$, и $\dim(V) = n$. Тогда
$\Ker(T^n) = \Ker(T^{n+1}) = \dots = \Ker(T^{n+j}) = \dots$.
\end{proposition}
\begin{proof}
Предположим, что $\Ker(T^n)\neq\Ker(T^{n+1})$.
Посмотрим на включение $\Ker(T^0)\leq\Ker(T)$.
Если в нем имеет место равенство, то
(по лемме~\ref{lemma:series-of-kernels}) и $\Ker(T^n)=\Ker(T^{n+1})$.
Значит, $\Ker(T^0)\neq \Ker(T)$. Аналогично,
$$
\Ker(T)\neq\Ker(T^2)\neq\Ker(T^3)\neq\dots\neq\Ker(T^n)\neq\Ker(T^N{n+1}).
$$
Но тогда $\dim(\Ker(T))\geq 1$, $\dim(\Ker(T^2))\geq 2$, \dots,
$\dim(\Ker(T^{n+1})) \geq n+1$. Но $\Ker(T^{n+1})$~--- подпространство
в $V$, и не может иметь размерность, большую $n$.
Получили противоречие.
Мы показали, что $\Ker(T^n) = \Ker(T^{n+1})$, а
по лемме~\ref{lemma:series-of-kernels} из этого следует
и всех следующих подпространств в нашей цепочке.
\end{proof}

Следующее предложение оказывается ключом к разложению пространства
в прямую сумму подпространств, на каждом из которых
ситуацию проще исследовать.

\begin{proposition}\label{prop:ker-im-direct-sum}
Пусть $T\colon V\to V$~--- линейный оператор на пространстве
размерности $n$. Тогда
$V = \Ker(T^n)\oplus\Img(T^n)$.
\end{proposition}
\begin{proof}
Покажем сначала, что $\Ker(T^n)\cap\Img(T^n) = 0$.
Действительно, пусть $v\in\Ker(T^n)\cap\Img(T^n)$.
Тогда $v = T^n(u)$; с другой стороны, $T^n(v) = T^n(T^n(u))=0$.
Поэтому $u\in\Ker(T^{2n}) = \Ker(T^n)$ (по
предложению~\ref{prop:nilpotence-degree-is-bounded}), откуда
$v = T^n(u) = 0$.

Мы показали, что сумма $\Ker(T^n) + \Img(T^n)\leq V$ прямая.
По следствию~\ref{cor:direct-sum-dimension}
тогда $\dim(\Ker(T^n)+\Img(T^n)) = \dim\Ker(T^n)
+\dim\Img(T^n)$. По теореме
о гомоморфизме~\ref{thm:homomorphism-linear} эта сумма
размерностей равна $\dim V$,
и потому $\Ker(T^n)\oplus\Img(T^n) = V$.
\end{proof}

Выше мы разобрались с диагональными операторами за счет того,
что для них имеет место разложение в прямую сумму
инвариантных $T$-подпространств вида
$V = V_{\lambda_1}\oplus\dots\oplus V_{\lambda_m}$,
где $\lambda_1,\dots,\lambda_m$~--- все различные собственные числа
оператора $T$. Сейчас мы покажем, что для произвольного оператора
имеет место аналогичное разложение, если собственные
подпространства заменить на чуть большие
{\em корневые}.

\begin{definition}
Пусть $T\colon V\to V$~--- линейный оператор,
и $\lambda\in k$~--- его собственное число.
Ненулевой вектор $v\in V$ называется \dfn{корневым вектором}
оператора $T$, соответствующим собственному числу $\lambda$,
если $(T-\id_V\lambda)^j(v) = 0$ для некоторого натурального $j$.
\end{definition}
\begin{remark}\label{rem:gen-eigen-is-a-subspace}
Предположим, что $(T-\id_V\lambda)^j(v) = 0$ для некоторого
$j$. По предложению~\ref{prop:nilpotence-degree-is-bounded}
тогда и $(T-\id_V\lambda)^n(v) = 0$, где $n = \dim(V)$.
Поэтому корневые векторы~--- это на самом деле в точности
ненулевые элементы $\Ker(T - \id_V\lambda)^n$.
\end{remark}
\begin{definition}
Множество всех корневых векторов оператора $T$, соответствующих
собственному числу $\lambda$, вместе с нулем, называется
\dfn{корневым подпространством} и обозначается через $V(\lambda,T)$.
Зачастую из контекста понятно, о каком операторе
идет речь, и мы пишем $V(\lambda)$ вместо $V(\lambda,T)$.
По замечанию~\ref{rem:gen-eigen-is-a-subspace} это действительно
подпространство: $V(\lambda,T) = \Ker(T - \id_V\lambda)^n$,
где $n = \dim(V)$.
\end{definition}

\begin{theorem}\label{thm:gen-eigenvectors-are-independent}
Пусть $T\colon V\to V$~--- линейный оператор,
$\lambda_1,\dots,\lambda_m$~--- его попарно различные собственные
числа, $v_1,\dots,v_m$~--- соответствующие им корневые векторы.
Тогда $v_1,\dots,v_m$ линейно независимы.
\end{theorem}
\begin{proof}
Предположим, что $v_1,\dots,v_m$ линейно зависимы. По
лемме~\ref{lemma:linear-dependence-lemma} найдется индекс
$j$ такой, что $v_j = v_1a_1 + \dots + v_{j-1}a_{j-1}$
для некоторых $a_1,\dots,a_{j-1}\in k$. Выберем наименьшее
такое $j$.
Вектор $v_j$ является корневым, соответствующим собственному числу
$\lambda_j$. Возьмем наименьшую степень $d$
оператора $(T-\id_V\lambda_j)$, которая не переводит этот вектор в $0$.
Иными словами, пусть $(T-\id_V\lambda_j)^d(v_j)\neq 0$
и $(T-\id_V\lambda_j)^{d+1}(v_j) = 0$.
Обозначим $(T-\id_V\lambda_j)^d(v_j) = w$.
Тогда $(T-\id_V\lambda_j)(w) = 0$, и поэтому $Tw = w\lambda_j$.
Более того, $(T-\id_V\lambda)(w) = T(w) - w\lambda
= w(\lambda_j - \lambda)$ для всех $\lambda\in k$.
Поэтому $(T-\id_V\lambda)^k(w) = w(\lambda_i-\lambda)^k$
для всех натуральных $k$.

Пусть $\dim V = n$.
Применим к нашей линейной зависимости оператор
$(T-\id_V\lambda_1)^n\dots(T-\id_V\lambda_{j-1})^n(T-\id_V\lambda_j)^d$.
В левой части получим
$$
(T-\id_V\lambda_1)^n\dots(T-\id_V\lambda_{j-1})^n(T-\id_V\lambda_j)^d(v_j).
$$
Сначала к вектору $v_j$ применяется оператор $(T-\id_V\lambda_j)^d$,
и получается вектор $w$, а потом применяются по очереди
операторы вида $(T-\id_V\lambda_i)^n$ для $i\neq j$.
Но выше мы выяснили, как они действуют: такой оператор
просто умножает $w$ на $(\lambda_j - \lambda_i)^n$.
Поэтому результат равен
$(\lambda_j-\lambda_1)^n\dots(\lambda_j-\lambda_{j-1})^n w$
и отличен от нуля.

В правой же части происходит следующее: при вычислении
действия оператора $(T-\id_V\lambda_1)^n\dots(T-\id_V\lambda_{j-1})^n
(T-\id_V\lambda_j)^d$ на $v_i$ (где $1\leq i\leq j-1$)
можно переставить скобки так, чтобы сначала действовала
скобка $(T-\id_V\lambda_i)^n$. Но $(T-\id_V\lambda_i)^n(v_i) = 0$
по определению корневого вектора. Поэтому каждое слагаемое
в правой части равно нулю.
Мы получили, что ненулевой вектор равен нулевому; это противоречие,
которое завершает доказательство.
\end{proof}

\begin{lemma}\label{lemma:poly-ker-and-im-are-invariant}
Пусть $T\colon V\to V$~--- линейный оператор,
$p\in k[x]$~--- многочлен. Тогда подпространства
$\Ker(p(T))$ и $\Img(p(T))$ $T$-инвариантны.
\end{lemma}
\begin{proof}
Пусть $v\in\Ker(p(T))$, то есть, $p(T)(v)=0$.
Тогда
$$
p(T)(T(v)) = (p(T)\cdot T)(v) = (T\cdot p(T))(v) = T(p(T)(v))
= T(0) = 0.
$$
Мы получили, что $T(v)\in\Ker(p(T))$, и потому $\Ker(p(T))$
действительно $T$-инвариантно.

Пусть теперь $v\in\Img(p(T))$, то есть,
$v = p(T)(u)$ для некоторого $u\in V$.
Тогда $T(v) = T(p(T)(u)) = p(T)(T(u)) \in\Img(p(T))$,
что и требовалось.
\end{proof}

Теперь мы готовы показать, что пространство раскладывается
в прямую сумму корневых.
Для этого нам понадобится следующее определение.
\begin{definition}
Линейный оператор $T\colon V\to V$ называется \dfn{нильпотентным},
если $T^j=0$ для некоторого натурального $j$.
\end{definition}

\begin{theorem}\label{thm:root-space-decomposition}
Пусть $T\colon V\to V$~--- линейный оператор на конечномерном
пространстве $V$ над алгебраически замкнутым полем $k$,
$\lambda_1,\dots,\lambda_m$~--- все его (попарно различные)
собственные числа. Тогда
\begin{enumerate}
\item $V = V(\lambda_1,T) \oplus \dots \oplus V(\lambda_m,T)$;
\item каждое из подпространств $V(\lambda_j,T)$ является
$T$-инвариантным;
\item оператор $(T-\id_V\lambda_j)|_{V(\lambda_j,T)}$ на
корневом подпространстве $V(\lambda_j,T)$ нильпотентен.
\end{enumerate}
\end{theorem}
\begin{proof}
Пусть $\dim(V) = n$.
Заметим сначала, что $V(\lambda_j,T) = \Ker(T-\id_V\lambda_j)^n$,
и его $T$-инвариантность следует из
леммы~\ref{lemma:poly-ker-and-im-are-invariant}, примененной
к многочлену $p(x) = (x-\lambda_j)^n$.

Далее, если $v\in V(\lambda_j,T)$, то $(T-\id_V\lambda_j)^n(v) = 0$.
Поэтому оператор $(T-\id_V\lambda_j)^n$ тождественно равен $0$
на подпространстве $V(\lambda_j,T)$, откуда следует нильпотентность
оператора $(T-\id_V\lambda_j)|_{V(\lambda_j,T)}$.

Осталось показать, что $V$ раскладывается в прямую сумму корневых.
Будем доказывать это индукцией по $n$. Случай $n=1$ очевиден.
Пусть теперь $n>1$, и нужный результат верен для всех пространств
меньшей размерности.
По предложению~\ref{prop:operator-has-an-eigenvalue}
у $T$ есть собственное число; поэтому $m\geq 1$.
По лемме~\ref{prop:ker-im-direct-sum}
тогда $V = \Ker(T-\id_V\lambda_1)^n \oplus \Img(T-\id_V\lambda_1)^n$.
Первое подпространство в прямой сумме~--- это в точности
$V(\lambda_1,T)$, а второе давайте обозначим через $U$.
Пространство $V(\lambda_1,T)$ нетривиально, и потому
размерность $U$ строго меньше размерности $V$.
Кроме того, подпространство $U$ является $T$-инвариантным по
лемме~\ref{lemma:poly-ker-and-im-are-invariant}.
Значит, к оператору $T|_U$, действующему на пространстве $U$,
можно применить предположение индукции, и получить, что
$$
U = V(\mu_1,T|_U)\oplus\dots \oplus V(\mu_k,T|_U),
$$
где $\mu_1,\dots,\mu_k$~--- собственные числа оператора
$T|_U$. Покажем, что любое собственное число $\lambda$ оператора $T|_U$
является и собственным числом оператора $T$. Действительно,
если $T|_U(u)=u\lambda$ для некоторого ненулевого вектора $u\in U$,
то и $T(u) = u\lambda$. Заметим также, что у оператора $T|_U$
не может быть собственного числа $\lambda_1$:
если $T|_U(u)=u\lambda_1$ то $T(u) = u\lambda_1$, и потому
$u\in \Ker(T-\id_V\lambda_1)^n$, и из разложения в прямую сумму
$V = \Ker(T-\id_V\lambda_1)^n\oplus U$ следует, что $u=0$.

Мы получили, что $\mu_1,\dots,\mu_k$~--- это какие-то из чисел
$\lambda_2,\dots,\lambda_m$. Возьмем какое-нибудь одно из
$\mu_1,\dots,\mu_k$; пусть это $\lambda_j$.
Несложно понять, что $V(\lambda_j,T|_U) \leq V(\lambda_j,T)$:
действительно, если $u\in U$~--- корневой вектор для собственного
числа $\lambda_j$ оператора $T|_U$, то тем более
$u$ является корневым вектором для собственного числа $\lambda_j$
оператора $T$.

Вернемся к общей картине.
По теореме~\ref{thm:gen-eigenvectors-are-independent}
сумма корневых подпространств прямая; получаем,
что $V(\lambda_1,T)\oplus\dots V(\lambda_m,T)\leq V$.
С другой стороны, мы показали, что $V = V(\lambda_1,T)\oplus U$,
и $U$ раскладывается в прямую сумму слагаемых, каждое из которых
содержится в каком-то $V(\lambda_j,T)$.
Поэтому
\begin{align*}
V &= V(\lambda_1,T)\oplus U \\
&= V(\lambda_1,T)\oplus V(\mu_1,T|_U)\oplus\dots\oplus V(\mu_k,T|_U) \\
&\leq V(\lambda_1,T)\oplus V(\lambda_2,T)\oplus \dots \oplus V(\lambda_m,T),
\end{align*}
и мы получили включение в обратную сторону.
\end{proof}

\begin{corollary}
Пусть $T\colon V\to V$~--- линейный оператор на конечномерном
пространстве $V$ над алгебраически замкнуты м полем $k$.
Тогда у пространства $V$ есть базис, состоящий из корневых векторов
оператора $T$.
\end{corollary}
\begin{proof}
Выберем базисы в каждом из подпространств вида $V(\lambda_j,T)$
и объединим их.
\end{proof}

\subsection{Характеристический и минимальный многочлены}

\begin{definition}
Пусть $V$~--- векторное пространство над алгебраически замкнутым полем $k$,
$T\colon V\to V$~--- линейный оператор, $\lambda\in k$~--- его собственное число.
Размерность соответствующего корневого подпространства $V(\lambda,T)$
называется \dfn{кратностью собственного числа $\lambda$}.
Иными словами, кратность собственного числа $\lambda$ оператора $T$
равна $\dim(\Ker(T-\id_V\lambda)^{\dim(V)})$.
\end{definition}

\begin{remark}
Иногда то, что мы называем кратностью, в литературе называется
{\em алгебраической кратностью}, в то время как размерность собственного подпространства
$V_\lambda(T)$ называется {\em геометрической кратностью} $\lambda$.
После этого доказывается теорема о том, что геометрическая кратность не превосходит
алгебраической кратности, которая при наших определениях очевидна
(собственное подпространство содержится в корневом).
\end{remark}

\begin{corollary}\label{cor:sum-of-multiplicities}
Сумма кратностей всех собственных чисел оператора $T\colon V\to V$ равна $\dim(V)$.
\end{corollary}
\begin{proof}
Тривиально следует из теоремы~\ref{thm:root-space-decomposition}
и следствия~\ref{cor:direct-sum-dimension}.
\end{proof}

\begin{definition}
Пусть $V$~--- векторное пространство над алгебраически замкнутым полем $k$,
$T\colon V\to V$~--- линейный оператор. Пусть $\lambda_1,\dots,\lambda_m$~--- все его
[попарно различные] собственные числа, а $d_1,\dots,d_m$~--- их кратности, соответственно.
Многочлен $(x-\lambda_1)^{d_1}\dots(x-\lambda_s)^{d_m}$ называется
\dfn{характеристическим многочленом} оператора $T$.
\end{definition}
\begin{proposition}\label{prop:degree-and-roots-of-char-poly}
Степень характеристического многочлена оператора $T\colon V\to V$ равна $\dim(V)$,
а его корни~--- в точности собственные числа оператора $T$.
\end{proposition}
\begin{proof}
Очевидно из определения и следствия~\ref{cor:sum-of-multiplicities}.
\end{proof}

\begin{theorem}[Гамильтона--Кэли]\label{thm:cayley-hamilton}
Пусть $V$~--- векторное пространство над алгебраически замкнутым полем $k$,
$T\colon V\to V$~--- линейный оператор, $q\in k[x]$~--- его характеристический многочлен.
Тогда $q(T) = 0$.
\end{theorem}
\begin{proof}
Пусть $\lambda_1,\dots,\lambda_m$~--- все собственные числа оператора $T$,
а $d_1,\dots,d_m$~--- их кратности. По теореме~\ref{thm:root-space-decomposition}
ограничения вида $(T-\id_V\lambda_j)|_{V(\lambda_j,T)}$ нильпотентны,
а по предложению~\ref{prop:nilpotence-degree-is-bounded} тогда
$(T-\id_V\lambda_j)^{d_j}|_{V(\lambda_j,T)} = 0$.

Любой вектор из $V$ является суммой векторов из $V(\lambda_1,T),\dots,V(\lambda_m,T)$
(по теореме~\ref{thm:root-space-decomposition}), поэтому достаточно доказать,
что $q(T)(v_j)=0$ для любого $v_j\in V(\lambda_j,T)$.
По определению
$$
q(T) = (T-\id_V\lambda_1)^{d_1}\dots (T-\id_V\lambda_m)^{d_m}.
$$
Операторы в правой части являются многочленами от оператора $T$, и потому коммутируют
друг с другом. Переставим их так, чтобы множитель $(T-\id_V\lambda_j)^{d_j}$ оказался
последним. Но $(T-\id_V\lambda_j)^{d_j}(v_j)=0$, и потому $q(T)(v_j)=0$,
что и требовалось.
\end{proof}

\begin{definition}\label{dfn:minimal-polynomial}
Пусть $T\colon V\to V$~--- линейный оператор на векторном пространстве $V$.
Многочлен $p\in k[x]$ минимальной степени со старшим коэффициентом $1$,
для которого $p(T)=0$, называется \dfn{минимальным многочленом} оператора $T$.
Иными словами, многочлен $p\in k[x]$ со старшим коэффициентом $1$ называется
минимальным многочленом оператора $T$, если
\begin{itemize}
\item $p(T)=0$;
\item если $f\in k[x]$~--- многочлен со старшим коэффициентом $1$, для
которого $f(T)=0$, то $\deg f\geq \deg p$.
\end{itemize}
\end{definition}

Покажем, что это определение осмысленно: у каждого оператора $T$
(на конечномерном пространстве $V$) существует единственный
минимальный многочлен. Пусть $\dim(V)=n$.
Рассмотрим множество операторов $\id_V,T,T^2,\dots,T^{n^2}$. В нем
$n^2+1$ элемент, в то время как размерность пространства всех
линейных операторов на $V$ равна $n^2$
(по теореме~\ref{thm:hom-isomorphic-to-m}). Значит, указанный набор
операторов линейно зависим. Выберем минимальное $m$, для которого
операторы $\id_V,T,T^2,\dots,T^m$ линейно зависимы. Тогда
$T^m$ выражается через $\id_V,T,T^2,\dots,T^{m-1}$:
$$
T^m = \id_V a_0 + Ta_1 + \dots + T^{m-1}a_{m-1}
$$
для некоторых $a_0,\dots,a_{m-1}\in k$.
Пусть $p\in k[x]$~--- следующий многочлен:
$$
p = x^m - a_{m-1}x^{m-1} - \dots - a_1x - a_0.
$$
Тогда $p(T)=0$. Предположим, что $f$~--- еще один многочлен той же степени
$m$ со старшим коэффициентом $1$, для которого $f(T)=0$.
Тогда многочлен $f-p$ имеет меньшую степень, но
$(f-p)(T) = f(T) - p(T) = 0$, что противоречит выбору $m$.

Следующее предложение полностью описывает многочлены $f\in k[x]$, для которых
$f(T) = 0$.
\begin{proposition}\label{prop:minimal-divides-annuling}
Пусть $T\colon V\to V$~--- линейный оператор, $f\in k[x]$~--- некоторый
многочлен.
Равенство $f(T)=0$ равносильно тому, что $f$ делится на минимальный
многочлен оператора $T$.
\end{proposition}
\begin{proof}
Пусть $p$~--- минимальный многочлен оператора $T$. Если $f$ делится на $p$,
то есть, $f=pq$ для некоторого многочлена $q\in k[x]$,
то $f(T) = p(T)q(T) = 0$.
Обратно, если $f(T)=0$, поделим с остатком $f$ на $p$:
$f = pq+r$ для $q,r\in k[x]$, причем $\deg(r) < \deg(p)$.
Но $r(T) = f(T)-p(T)q(T) = 0$, что противоречит минимальности
многочлена $p$.
\end{proof}
\begin{corollary}
Пусть $V$~--- векторное пространство над алгебраически замкнутым полем $k$,
$T\colon V\to V$~--- линейный оператор.
Тогда характеристический многочлен оператора $T$ делится на его
минимальный многочлен.
\end{corollary}
\begin{proof}
Немедленно следует из теоремы Гамильтона--Кэли~\ref{thm:cayley-hamilton}
и предложения~\ref{prop:minimal-divides-annuling}.
\end{proof}

\begin{proposition}\label{prop:roots-of-minuimal-are-eigenvalues}
Пусть $T$~--- линейный оператор на $V$. Корни минимального многочлена
оператора $T$~--- это в точности все собственные числа этого оператора.
\end{proposition}
\begin{proof}
Пусть $p$~--- минимальный многочлен оператора $T$.
Если $\lambda\in k$~--- корень $p$, то $p(x) = (x-\lambda)q$
для некоторого многочлена $q\in k[x]$ со старшим коэффициентом $1$.
Из равенства $p(T)$ следует, что
$(T-\id_V\lambda)(q(T)(v))=0$ для всех $v\in V$.
Заметим, что степень $q$ меньше степени минимального многочлена оператора $T$,
и потому $q(T)\neq 0$. Поэтому найдется вектор $v\in V$, для которого
$q(T)(v)\neq 0$. Но тогда равенство $(T-\id_V\lambda)(q(T)(v))=0$ означает,
что $\lambda$~--- собственное число оператора $T$ (а $q(T)(v)$~---
соответствующий ему собственный вектор).

Обратно, пусть $\lambda\in k$~--- собственное число оператора $T$.
Тогда найдется ненулевой вектор $v\neq 0$, для которого
$T(v) = \lambda v$. Применяя несколько раз $T$ к обеим частям этого равенства,
получаем, что $T^j(v) = \lambda^j v$ для всех $j\geq 0$.
Поэтому $p(T)(v)= p(\lambda)(v)$; с другой стороны, $p(T)(v)=0$.
При этом вектор $v$ отличен от нуля, значит, $p(\lambda)=0$.
\end{proof}

\subsection{Жорданов базис для нильпотентного оператора}

\literature{[F], гл. XII, \S~6, пп. 2--4; [K2], гл. 2, \S~4, пп. 4--6; [KM], ч. 1, \S~9; [vdW], гл. XII, \S\S~88, 89.}

Напомним, что по теореме~\ref{thm:root-space-decomposition} изучение
оператора $T$ сводится к изучению нильпотентных операторов.
Теперь мы готовы построить хороший базис для нильпотентного оператора.
\begin{theorem}\label{thm:jordan-basis-nilpotent}
Пусть $V$~--- векторное пространство над полем $k$,
$N\colon V\to V$~--- нильпотентный оператора.
Тогда найдутся векторы $v_1,\dots,v_s\in V$ и натуральные числа
$m_1,\dots,m_s$ такие, что
\begin{itemize}
\item векторы
\begin{align*}
& N^{m_1}(v_1),\dots,N(v_1),v_1, \\
& N^{m_2}(v_2),\dots,N(v_2),v_2, \\
& \dots \\
& N^{m_s}(v_s),\dots,N(v_s),v_s
\end{align*}
образуют базис $V$;
\item $N^{m_1+1}(v_1) = \dots = N^{m_s+1}(v_s)=0$.
\end{itemize}
\end{theorem}
\begin{remark}\label{rem:jordan-basis-scheme}
Полученный базис удобно схематично изображать в виде ориентированного
графа, вершины которого символизируют векторы базиса, а ребра
выражают действие оператора $N$. Набор
$N^{m_1}(v_1),\dots,N(v_1),v_1$ тогда представляется в виде
цепочки из $m_1+1$ вершины:
$$
\begin{tikzpicture}[every label/.style={font=\scriptsize}]
\coordinate [label=right:{$N^{m_1}(v_1)$}] (1) at (0,10);
\coordinate [label=right:{$N^{m_1-1}(v_1)$}] (2) at (0,9);
\coordinate [label=right:{$N(v_1)$}] (3) at (0,7);
\coordinate [label=right:{$v_1$}] (4) at (0,6);
\draw [-{Stealth}] (1)--($(0,9)+(0,0.05)$);
\draw [-{Stealth}] (3)--($(0,6)+(0,0.05)$);
\draw (0,9)--(0,8.5);
\draw [-{Stealth}] (0,7.5)--(0,7.05);
\coordinate (dot1) at (0,8.2);
\coordinate (dot2) at (0,8);
\coordinate (dot3) at (0,7.8);
\foreach \point in {dot1,dot2,dot3} {
	\fill [black] (\point) circle (1pt);
}
\foreach \point in {1,2,3,4} {
	\fill [black] (\point) circle (2pt);
}
\end{tikzpicture}
$$
Очевидно, что подпространство, порожденное векторами из одной такой цепочки,
$N$-инвариантно. Матрица ограничения оператора $N$ на это подпространство
(в этом базисе) имеет размер $(m_1+1)\times (m_1+1)$ и выглядит так:
$$
\begin{pmatrix}
0 & 1 & 0 & \dots & 0 & 0 \\
0 & 0 & 1 & \dots & 0 & 0 \\
0 & 0 & 0 & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & 0 & 1 \\
0 & 0 & 0 & \dots & 0 & 0 \\
\end{pmatrix}
$$
Базис, о котором идет речь в теореме~--- набор из
$s$ таких цепочек (возможно, разной длины). Матрица оператора $N$
в таком базисе, стало быть, имеет блочно-диагональный вид,
и на диагонали стоят блоки указанного вида.
\end{remark}
\begin{proof}[Доказательство теоремы~\ref{thm:jordan-basis-nilpotent}]
Будем доказывать теорему индукцией по размерности пространства $V$.
Случай $\dim(V)=1$ тривиален: нильпотентный оператор на одномерном
пространстве должен быть нулевым, и мы можем положить $s=1$, выбрать
любой ненулевой вектор $v_1\in V$ и $m_1=0$.

Пусть теперь $\dim(V)>1$. Рассмотрим подпространство $\Img(N)\leq V$.
Если оно совпадает с $V$, то оператор $N$ обратим, что противоречит
его нильпотентности. Поэтому $\Img(N)$~--- подпространство в $V$
меньшей размерности.
Если случилось так, что $\Img(N)$~--- нулевое пространство, то
оператор $N$ нулевой, и потому можно выбрать произвольный базис
$v_1,\dots,v_s$ пространства $V$ и положить $m_1=\dots=m_s=0$;
на этом доказательство заканчивается.

Если же $\Img(N)\neq 0$, то к нему можно применить предположение индукции.
Значит, мы можем выбрать векторы $v_1,\dots,v_s\in\Img(N)$ и натуральные числа
$m_1,\dots,m_s$ так, что заключение теоремы выполнено (для подпространства
$\Img(N)$). Для каждого вектора $v_i\in\Img(N)$ можно выбрать
$u_i\in V$ так, что $v_i=N(u_i)$. Переписав заключение теоремы в терминах
векторов $u_i$, получаем, что набор
\begin{align*}
& N^{m_1+1}(u_1),\dots,N^2(u_1),N(u_1), \\
& N^{m_2+1}(u_2),\dots,N^2(u_2),N(u_2), \\
& \dots \\
& N^{m_s+1}(u_s),\dots,N^2(u_s),N(u_s)
\end{align*}
образует базис пространства $\Img(N)$,
в то время как $N^{m_1+2}(u_1) = \dots = N^{m_s+2}(u_s) = 0$.
Какие же векторы можно добавить, чтобы получить базис всего пространства
$V$, имеющий нужный вид <<цепочек>> векторов?
Первое предположение~--- попытаться добавить векторы $u_1,\dots,u_s$.
Покажем, что полученный набор
\begin{align*}
& N^{m_1+1}(u_1),\dots,N^2(u_1),N(u_1),u_1, \\
& N^{m_2+1}(u_2),\dots,N^2(u_2),N(u_2),u_2, \\
& \dots \\
& N^{m_s+1}(u_s),\dots,N^2(u_s),N(u_s),u_s
\end{align*}
будет линейно зависим.
Действительно, рассмотрим линейную комбинацию этих векторов, равную нулю.
Подействуем на эту линейную комбинацию оператором $N$.
Мы получим линейную комбинацию векторов
\begin{align*}
& N^{m_1+2}(u_1),\dots,N^2(u_1),N(u_1), \\
& N^{m_2+2}(u_2),\dots,N^2(u_2),N(u_2), \\
& \dots \\
& N^{m_s+2}(u_s),\dots,N^2(u_s),N(u_s),
\end{align*}
однако, мы знаем, что векторы $N^{m_1+2}(u_1),\dots,N^{m_s+2}(u_s)$
равны нулю. Поэтому остается линейная комбинация в точности тех векторов,
про которые мы знаем, что они образуют базис $\Img(N)$.
Разумеется, из этого следует, что все коэффициенты в ней равны нулю.
Возвращаясь к исходной линейной комбинации, видим, что все коэффициенты
в ней, кроме, возможно, коэффициентов при векторах
$N^{m_1+1}(u_1),\dots,N^{m_s+1}(u_s)$, равны нулю.
Но тогда остается линейная комбинация, состоящая только из указанных
векторов, равная нулю. Эти векторы тоже входят в состав выбранного
по предположению индукции базиса $\Img(N)$, и потому линейно независимы.
Значит, и коэффициенты при них в исходной линейной комбинации также равны нулю.

Итак, мы показали, что векторы
\begin{align*}
& N^{m_1+1}(u_1),\dots,N^2(u_1),N(u_1),u_1, \\
& N^{m_2+1}(u_2),\dots,N^2(u_2),N(u_2),u_2, \\
& \dots \\
& N^{m_s+1}(u_s),\dots,N^2(u_s),N(u_s),u_s
\end{align*}
линейно независимы. Образуют ли они базис пространства $V$? Вообще говоря,
не обязательно. Поэтому дополним их как-нибудь векторами $w_1,\dots,w_t$
до базиса $V$. Это еще не нужный нам базис пространства $V$: нужно его
слегка подправить. Заметим, что $N(w_j)\in\Img(N)$ для всех $j$,
и потому $N(w_j)$ является линейной комбинацией векторов
\begin{align*}
& N^{m_1+1}(u_1),\dots,N^2(u_1),N(u_1), \\
& N^{m_2+1}(u_2),\dots,N^2(u_2),N(u_2), \\
& \dots \\
& N^{m_s+1}(u_s),\dots,N^2(u_s),N(u_s),
\end{align*}
образующих, как мы знаем, базис пространства $\Img(N)$.
Каждая такая линейная комбинация, очевидно, имеет вид $N(x_j)$, где $x_j$~---
линейная комбинация векторов
\begin{align*}
& N^{m_1}(u_1),\dots,N(u_1),u_1, \\
& N^{m_2}(u_2),\dots,N(u_2),u_2, \\
& \dots \\
& N^{m_s}(u_s),\dots,N(u_s),u_s.
\end{align*}
Мы нашли векторы $x_j\in V$ такие, что $N(w_j) = N(x_j)$.
Положим $u_{s+j} = w_j - x_j$.
Теперь мы утверждаем, что векторы
\begin{align*}
& N^{m_1+1}(u_1),\dots,N^2(u_1),N(u_1),u_1, \\
& \dots \\
& N^{m_s+1}(u_s),\dots,N^2(u_s),N(u_s),u_s, \\
& u_{s+1}, \\
& \dots \\
& u_{s+t}
\end{align*}
образуют нужный нам базис пространства $V$.
Напомним, что мы стартовали с базиса, в котором вместо
векторов $u_{s+j}$ были векторы $w_j$, и вычли из каждого $w_j$
некоторую линейную комбинацию $x_j$ предыдущих векторов из того же базиса.
Нетрудно видеть, что такая замена обратима, и потому полученный набор
векторов также будет базисом пространства $V$.
Кроме того, выполнено и второе условие из заключения теоремы:
$$
N^{m_1+2}(u_1) = \dots = N^{m_s+2}(u_s) = N(u_{s+1}) = \dots = N(u_{s+t}),
$$
поскольку $N(u_{s+j}) = N(w_j-x_j) = N(w_j)-N(x_j) = 0$.
\end{proof}

\subsection{Жорданова форма}

\literature{[F], гл. XII, \S~6, п. 4; [K2], гл. 2, \S~4, пп. 1, 2; [KM], ч. 1, \S~9; [vdW], гл. XII, \S~87.}

Теперь мы готовы сформулировать основной результат о линейных операторах
на конечномерных векторных пространствах над алгебраически
замкнутым полем.
\begin{definition}
Матрица вида
$$
J_n(\lambda)=
\begin{pmatrix}
\lambda & 1 & 0 & \dots & 0 & 0 \\
0 & \lambda & 1 & \dots & 0 & 0 \\
0 & 0 & \lambda & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & \lambda & 1 \\
0 & 0 & 0 & \dots & 0 & \lambda
\end{pmatrix}
$$
размера $n\times n$ называется \dfn{жордановым блоком}.
Блочно-диагональная матрица, в которой каждый блок является жордановым блоком,
называется \dfn{жордановой матрицей}.
Пусть $T\colon V\to V$~--- линейный оператор. Базис пространства $V$
называется \dfn{жордановым базисом} для оператора $T$, если матрица
$T$ в этом базисе является жордановой. Эта матрица тогда называется
\dfn{жордановой формой} оператора $T$.
\end{definition}

Для доказательства основной теоремы нам понадобится следующая лемма:
\begin{lemma}\label{lemma:dim-ker-for-direct-sum}
Пусть $V$~--- векторное пространство над полем $k$,
$T\colon V\to V$~--- линейный оператор, и
пусть $V = U_1\oplus\dots\oplus U_m$~--- разложение пространства
в прямую сумму подпространств, каждое из которых $T$-инвариантно.
Тогда
$$
\dim(\Ker(T)) = \dim(\Ker(T|_{U_1})) + \dots + \dim(\Ker(T|_{U_m}))
$$
и 
$$
\dim(\Img(T)) = \dim(\Img(T|_{U_1})) + \dots + \dim(\Img(T|_{U_m})).
$$
\end{lemma}
\begin{proof}
Очевидно, что $\Ker(T|_{U_i}) \leq \Ker(T)$. Кроме того, каждое
$\Ker(T|_{U_i})$ является подпространством в $U_i$. Сумма
$U_1 + \dots + U_m$ прямая, потому и сумма
$\Ker(T|_{U_1}) + \dots + \Ker(T|_{U_m})$ прямая.
Покажем, что $\Ker(T) \leq \Ker(T|_{U_1}) + \dots + \Ker(T|_{U_m})$.
Действительно, пусть $v\in\Ker(T)$, и $v = u_1+\dots+u_m$, где $u_i\in U_i$.
Тогда $0 = T(v) = T(u_1) + \dots + T(u_m)$. При этом каждый вектор
$T(u_i)$ лежит в $U_i$ в силу $T$-инвариантности подпространства $U_i$.
Из определения прямой суммы теперь следует, что каждое $T(u_i)$ равно нулю,
то есть, $u_i\in\Ker(T|_{U_i})$, и нужное включение доказано.

Таким образом, $\Ker(T) = \Ker(T|_{U_1})\oplus\dots\oplus\Ker(T|_{U_m})$.
Вычисляя размерности, получаем первое из требуемых равенств.
После этого второе следует по теореме
о гомоморфизме~\ref{thm:homomorphism-linear}.
\end{proof}

\begin{theorem}\label{thm:jordan-form}
Пусть $k$~--- алгебраически замкнутое поле, $V$~--- конечномерное векторное
пространство над $k$, $T$~--- линейный оператор на $V$. Тогда
в $V$ существует жорданов базис для $T$. Более того,
жорданова форма оператора $T$ единственна с точностью до перестановки
жордановых блоков.
\end{theorem}
\begin{proof}
По теореме~\ref{thm:root-space-decomposition} пространство $V$ раскладывается
в прямую сумму корневых подпространств оператора $T$. Более того,
если $\lambda_i\in k$~--- собственное число оператора $T$, то ограничение
оператора $T-\id_V\lambda_i$ на корневое подпространство $V(\lambda_i,T)$
нильпотентно. К этой ситуации можно применить
теорему~\ref{thm:jordan-basis-nilpotent} и выбрать базис в
$V(\lambda_i,T)$, в котором матрица оператора
$(T-\id_V\lambda_i)|_{V(\lambda_i,T)}$ имеет вид, описанный
в замечании~\ref{rem:jordan-basis-scheme}.
Матрица оператора $T|_{V(\lambda_i,T)}$ в выбранном базисе
получается прибавлением к ней скалярной матрицы с $\lambda_i$ на диагонали.
Получаем, что матрица оператора $T|_{V(\lambda_i,T)}$
имеет жорданов вид (а именно, состоит из блоков
$J_{m_1+1}(\lambda_i),\dots,J_{m_s+1}(\lambda_i$, где $m_1,\dots,m_s$
как в теореме~\ref{thm:root-space-decomposition}).
Проделав указанную процедуру для всех собственных чисел, мы получим
базис во всем пространстве $V$, в котором матрица оператора $T$
жорданова.

Осталось показать единственность жордановой формы. Заметим, что
на диагонали в жордановой формы обязаны стоять собственные числа
оператора $T$. Поэтому достаточно показать, что для каждого собственного
числа $\lambda$ оператора $T$ размеры блоков вида $J_?(\lambda)$,
встречающиеся в любой его жордановой форме, определены однозначно
(не зависят от выбора этой формы).
Для этого мы выразим количества блоков вида $J_1(\lambda),J_2(\lambda),
\dots$ через числа, которые никак не зависят от выбора базиса
в пространстве $V$.

А именно, пусть оператор $T$ приведен к жордановой форме
(некоторым выбором базиса). Фиксируем некоторое
собственное число $\lambda$ оператора $T$, и
пусть $n_m$~--- количество блоков вида $J_m(\lambda)$ в этой форме.
Будем считать, что максимальный размер блока такого вида
равен $s$, и потому $n_{s+1} = n_{s+2} = \dots = 0$.

Посмотрим на размерность ядра оператора $T-\id_V\lambda$.
Матрица этого оператора блочно-диагональна и составлена
из блоков вида $J_?(\lambda_i-\lambda)$, где $\lambda_i$~---
все собственные числа оператора $T$.
По лемме~\ref{lemma:dim-ker-for-direct-sum}
достаточно просуммировать размерности ядер этих блоков.
Если $\lambda_i\neq\lambda$, то блок вида
$J_?(\lambda_i-\lambda)$ обратим
по предложению~\ref{prop:when-ut-is-invertible},
и вносит нулевой вклад в суммарную размерность ядра.
В то же время, если $\lambda_i = \lambda$, то каждый
блок вида $J_t(\lambda_i-\lambda) = J_t(0)$ имеет ранг $t-1$
и размер $t$, поэтому вности вклад $1$ в суммарную размерность ядра.
Суммируя, получаем, что размерность ядра оператора
$T-\id_V\lambda$ равна количеству блоков вида $J_?(\lambda)$
в жордановой форме оператора $T$, то есть, $n_1+n_2+\dots+n_s$:
$$
\dim\Ker(T-\id_V\lambda) = n_1 + n_2 + n_3 + \dots + n_s.
$$

Теперь посчитаем размерность ядра оператора
$(T-\id_V\lambda)^2$. Снова можно
применить лемму~\ref{lemma:dim-ker-for-direct-sum},
и снова блоки в матрице оператора $T$ вида $J_?(\lambda_i)$
при $\lambda_i\neq\lambda$ вносят нулевой вклад в суммарную размерность
ядра. Посмотрим теперь на блок вида $J_t(\lambda)$.
Матрица оператора $(T-\id_V\lambda)^2$ равна
$(J_t(\lambda) - E_t\lambda)^2$. Нетрудно видеть,
что при возведении в квадрат матрица вида
$$
\begin{pmatrix}
0 & 1 & 0 & 0 & \dots & 0 \\
0 & 0 & 1 & 0 & \dots & 0 \\
0 & 0 & 0 & 1 & \dots & 0 \\
0 & 0 & 0 & 0 & \dots & 0 \\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & 0 & \dots & 0
\end{pmatrix}
$$
превращается в матрицу вида
$$
\begin{pmatrix}
0 & 0 & 1 & 0 & \dots & 0 \\
0 & 0 & 0 & 1 & \dots & 0 \\
0 & 0 & 0 & 0 & \dots & 0 \\
0 & 0 & 0 & 0 & \dots & 0 \\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & 0 & \dots & 0
\end{pmatrix}.
$$
Ранее мы посчитали, что каждый блок $J_t(\lambda)$ вносит вклад
$1$ в размерность $\Ker(T-\id_V\lambda)$. Теперь видно,
что блоки размера $2$ и больше вносят вклад еще на $1$ больше
в размерность $\Ker(T-\id_V\lambda)^2$. В то же время, блоки
размера $1\times 1$ при возведении в квадрат не меняются,
и потому вносят тот же вклад, что и раньше.
Мы получаем, что {\em разность} размерностей ядер
операторов $(T-\id_V\lambda)^2$ и $T-\id_V\lambda$
равна количеству блоков размера $2$ и больше:
$$
\dim\Ker(T-\id_V\lambda)^2 - \dim\Ker(T-\id_V\lambda) = n_2 + n_3 + \dots + n_s.
$$

Посчитаем размерность ядра оператора $(T-\id_V\lambda)^3$.
Аналогичные рассуждения показывают, что блоки размера $1$ и $2$
с собственным числом $\lambda$ при возведении в куб дают то же, что и
про возведении в квадрат, а вот у блоков размера $3$ и больше
единицы <<сдвигаются>> на диагональ выше, и потому они вносят
вклад на $1$ больше, чем в размерность ядра оператора
$(T-\id_V\lambda)^2$. Поэтому
$$
\dim\Ker(T-\id_V\lambda)^3 - \dim\Ker(T-\id_V\lambda)^2 = n_3 + \dots + n_s.
$$

Продолжая увеличивать степень, мы дойдем до последней:
$$
\dim\Ker(T-\id_V\lambda)^s - \dim\Ker(T-\id_V\lambda)^{s-1} = n_s.
$$
Полученные равенства можно воспринимать как систему линейных уравнений
на $n_1,\dots,n_s$. Нетрудно видеть теперь, что (как и обещано)
числа $n_1,\dots,n_s$ выражаются через размерности ядер степеней
оператора $(T-\id_V\lambda)$, то есть, через параметры, которые никак
не зависят от выбора базиса. Вычитая каждую строчку из
предыдущей, можно написать и явную формулу:
$$
n_m = 2\dim\Ker(T-\id_V\lambda)^m - \dim\Ker(T-\id_V\lambda)^{m-1}
-\dim\Ker(T-\id_V\lambda)^{m+1}.
$$
Поэтому количество блоков размера $m$ с собственным числом $\lambda$
в жордановой форме оператора $T$ не зависит от выбора жорданова базиса.
\end{proof}

\subsection{Комплексификация}

Жорданова форма дает ответ к задаче классификации линейных операторов
на конечномерном пространстве над алгебраически замкнутым полем.
Этот результат можно пытаться обобщать на разные контексты. Например,
можно задуматься о классификации операторов на бесконечномерных
пространствах. Наш подход существенно опирался на матричные вычисления,
которые не переносятся на бесконечномерный случай, поэтому мы
не будем этого делать. Второе направление обобщения~--- попробовать
посмотреть на случай незамкнутого поля.

Действительно, хотя случай алгебраически замкнутого поля уже
полезен для приложений (в большинстве неалгебраических приложений
встречается случай поля комплексных чисел $\mbC$), естественный интерес
представляют операторы над полем вещественных чисел.
Мы продемонстрируем, как основные понятия и факты об операторах
переносятся с $\mbC$ на $\mbR$.

Итак, пусть $V$~--- векторное пространство над полем вещественных
чисел $\mbR$. Мы детально изучили  пространства и операторы
над полем $\mbC$, поэтому первое, что нужно попробовать сделать~---
свести один случай к другому. А именно, мы построим по $V$
пространство $V_{\mbC}$ над полем комплексных чисел, и покажем,
что любой базис в $V$ превращается в базис пространства $V_{\mbC}$,
а любой линейный оператор на $V$~--- в линейный оператор на $V_{\mbC}$.

Рассмотрим множество $V\times V$. По определению оно состоит
из всевозможных упорядоченных пар $(u,v)$, где $u,v\in V$.
Мы же будем записывать пару $(u,v)$ в виде $u+vi$
и воспринимать как один вектор.
Сейчас мы введем на $V\times V$ структуру векторного пространства
над полем комплексных чисел $\mbC$.
Сложение определить несложно:
$(u_1+v_1i) + (u_2 +v_2i) = (u_1+u_2) + (v_1+v_2)i$
для всех $u_1,v_1,u_2,v_2\in V$.
Определим умножение на скаляр $a+bi\in\mbC$ следующим образом:
$(u + vi)(a + bi) = (au-bv) + (av+bu)i$.
Видно, что это определение совершенно естественно, и получается простым
раскрытием скобок с учетом тождества $i^2=-1$. Тем не менее, мы должны
проверить, что все свойства из определения векторного пространства
выполняются. К счастью, эта проверка совсем несложна, и мы оставляем
ее читателю в качестве упражнения. Отметим лишь, что роль нулевого элемента
играет вектор $0 = 0+0i$.

\begin{definition}
Полученное векторное пространство над $\mbC$ мы будем обозначать
через $V_\mbC$ и называть \dfn{комплексификацией} пространства $V$.
\end{definition}
Исходное векторное пространство $V$ мы будем
считать подмножеством в $V_\mbC$: если $v\in V$, то
$v+0i\in V_\mbC$.

\begin{proposition}\label{prop:complexification-basis}
Пусть $V$~--- векторное пространство над $\mbR$.
Если $v_1,\dots,v_n$~--- базис $V$ (как пространства над $\mbR$), то
$v_1,\dots,v_n$~--- базис $V_\mbC$ (как пространства над $\mbC$).
\end{proposition}
\begin{proof}
Заметим, что линейная оболочка векторов $v_1,\dots,v_n$ в $V_\mbC$
содержит векторы $v_1,\dots,v_n$ и векторы $v_1i,\dots,v_ni$.
Любой элемент $u\in V$ есть линейная комбинация векторов
$v_1,\dots,v_n$, и для любого $v\in V$ вектор $vi$ есть линейная
комбинация векторов $v_1i,\dots,v_ni$.
Поэтому любой элемент $u+vi\in V_\mbC$ лежит в линейной оболочке
$v_1,\dots,v_n$. Покажем, что $v_1,\dots,v_n$ линейно независимы
в $V_\mbC$. Если $a_1+b_1i,\dots,a_n+b_ni\in\mbC$ таковы, что
$v_1(a_1+b_1i) + \dots + v_n(a_n+b_ni) = 0$, то,
раскрывая скобки и приравнивая отдельно <<вещественные>> и <<мнимые>> части,
получаем, что
$v_1a_1+\dots+v_na_n = 0$
и $v_1b_1+\dots + v_nb_n = 0$. Из линейной независимости
векторов $v_1,\dots,v_n$ в $V$ следует, что
$a_1=\dots=a_n = b_1 = \dots = b_n = 0$.
Поэтому $v_1,\dots,v_n$ линейно независимы в $V_\mbC$.
\end{proof}

\begin{corollary}\label{cor:complexification-dimension}
Размерность $V_\mbC$ как векторного пространства над $\mbC$ равна
размерности $V$ как векторного пространства над $\mbR$.
\end{corollary}
\begin{proof}
Сразу следует из предложения~\ref{prop:complexification-basis}.
\end{proof}

\begin{definition}
Пусть $V$~--- векторное пространство над $\mbR$, $T$~--- линейный оператор
на $V$. Определим оператор $T_\mbC$ на пространстве $V_\mbC$ следующим образом:
$$
T_\mbC(u+vi) = T(u) + T(v)i
$$
для всех $u,v\in V$. Этот оператор называется
\dfn{комплексификацией} оператора $T$.
\end{definition}
Неформально говоря, оператор $T_\mbC$ действует отдельно на вещественную
и мнимую часть вектора $u+vi$ оператором $T$. Несложно проверить, что
эта формула действительно задает линейный оператор на пространстве $V_\mbC$.

\begin{lemma}
Пусть $V$~--- векторное пространство над $\mbR$ с базисом $v_1,\dots,v_n$,
$T\colon V\to V$~--- линейный оператор. Тогда матрица оператора $T$
в базисе $v_1,\dots,v_n$ совпадает с матрицей оператора $T_\mbC$ в том же
базисе.
\end{lemma}
\begin{proof}
Упражнение.
\end{proof}

Наш первый результат можно считать аналогом
предложения~\ref{prop:operator-has-an-eigenvalue}, которое утверждало,
что у любого оператора на конечномерном пространстве
над алгебраически замкнутым полем есть
одномерное инвариантное подпространство.

\begin{proposition}\label{prop:real-operator-invariant-subspace}
У любого оператора на (ненулевом) конечномерном векторном пространстве
над $\mbR$ есть инвариантное подпространство
размерности $1$ или $2$.
\end{proposition}
\begin{proof}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~---
линейный оператор. Его комплексификация $T_\mbC\colon V_\mbC\to V_\mbC$
имеет собственное число (по предложению~\ref{prop:operator-has-an-eigenvalue})
$a+bi$, где $a,b\in\mbR$. Пусть $u+vi$~--- соответствующий ему собственный
вектор; $u,v\in V$, при этом $u$ и $v$ не равны одновременно нулю.
Это означает, что $T_\mbC(u+vi) = (u+vi)(a+bi)$.
Используя определение $T_\mbC$ и умножения в пространстве $V_\mbC$, получаем
$$
T(u) + T(v)i = (ua-vb) + (va+ub)i.
$$
Поэтому $T(u) = ua-vb$ и $T(v) = va+ub$.
Пусть $U$~--- линейная оболочка векторов $u,v$ в $V$.
Тогда $U$~--- подпространство в $V$ размерности $1$ или $2$,
и полученные равенства показывают, что $U$ инвариантно относительно
оператора $T$.
\end{proof}

Напомним, что мы определили минимальный многочлен оператора
над произвольным полем $k$
(см.~определение~\ref{prop:operator-has-an-eigenvalue}).
\begin{proposition}\label{prop:minimal-poly-of-complexification}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор. Тогда минимальный многочлен оператора $T_\mbC$ равен
минимальному многочлену оператора $T$.
\end{proposition}
\begin{proof}
Пусть $p\in \mbR[x]$~--- минимальный многочлен оператора $T$.
Сейчас мы покажем, что он удовлетворяет определению минимального многочлена
оператора $T_\mbC$. Сначала необходимо показать, что $p(T_\mbC) = 0$.
Напомним, что по определению $T_\mbC(u+vi) = T(u) + T(v)i$.
Применяя к этому равенству оператор $T_\mbC$, получаем,
что $(T_\mbC)^n(u+vi) = T^n(u) + T^n(v)i$.
Поэтому $p(T_\mbC) = (p(T))_\mbC = 0$.

Пусть теперь $q\in\mbC[x]$~--- некоторый многочлен со старшим коэффициентом $1$,
для которого $q(T_\mbC)=0$. Нам нужно показать, что степень $q$ не меньше,
чем степень $p$. Заметим, что $(q(T_\mbC))(u) = 0$ для всех $u\in V$.
Обозначим через $r$ многочлен, $j$-й коэффициент которого равен
вещественной части $j$-го коэффициента многочлена $q$.
Очевидно, что старший коэффициент $r$ также равен единице.
Из равенства $(q(T_\mbC))(u) = 0$ немедленно следует, что $(r(T))(u) = 0$.
Это выполнено для всех $u\in V$, и потому $r(T)$~--- нулевой оператор.
В силу минимальности $p$ из этого следует, что $\deg r \geq \deg p$.
Но $\deg r = \deg q$, откуда $\deg q\geq \deg p$, что и требовалось.
\end{proof}

Теперь посмотрим на собственные числа комплексификации $T_\mbC$.
Каждое собственное число может оказаться вещественным, а может~---
невещественным. Оказывается, вещественные собственные числа
$T_\mbC$~--- это собственные числа исходного оператора $T$.
\begin{proposition}\label{prop:complexification-real-eigenvalues}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~---
линейный оператор, $\lambda\in\mbR$.
Число $\lambda$ является собственным числом оператора $T_\mbC$
тогда и только тогда, когда $\lambda$ является собственным числом
оператора $T$.
\end{proposition}
\begin{proof}
По предложению~\ref{prop:roots-of-minuimal-are-eigenvalues}
собственные числа оператора $T$ (которые вещественны по определению)~---
это в точности (вещественные) корни минимального многочлена оператора $T$.
С другой стороны
(снова по предложению~\ref{prop:roots-of-minuimal-are-eigenvalues}),
вещественные собственные числа оператора $T_\mbC$~---
это в точности вещественные корни минимального многочлена оператора $T_\mbC$.
По предложению~\ref{prop:minimal-poly-of-complexification} эти минимальные
многочлены совпадают.
\end{proof}

Следующее предложение утверждает, что $T_\mbC$ ведет себя симметрично
по отношению к собственному числу $\lambda$ и сопряженному к нему
$\ol\lambda$.
\begin{proposition}\label{prop:conjugation-of-eigenvalue}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор, $\lambda\in\mbC$, $j$~--- натуральное число, и $u,v\in V$.
Тогда
$$
(T_\mbC-\id_{V_\mbC}\lambda)^j(u+vi) = 0\;\Longleftrightarrow\;
(T_\mbC-\id_{V_\mbC}\ol\lambda)^j(u-vi) = 0.
$$
\end{proposition}
\begin{proof}
Будем доказывать утверждение индукцией по $j$. В случае $j=0$ слева и справа
стоит тождественный оператор, поэтому мы получаем утверждение,
что равенство $u+vi=0$ равносильно равенству $u-vi = 0$, что очевидно.
Пусть теперь $j\geq 1$, и мы доказали результат для $j-1$.
Предположим, что $(T_\mbC-\id\lambda)^j(u+vi) = 0$.
Это означает, что $(T_\mbC-\id\lambda)^{j-1}((T_\mbC-\id\lambda)(u+vi)) = 0$.
Пусть $\lambda=a+bi$, где $a,b\in\mbR$. Тогда
$$
(T_\mbC-\id\lambda)(u+vi) = (T(u)-ua+vb) + (T(v)-va-ub)i.
$$
Значит, наше равенство можно записать в виде
$$
(T_\mbC-\id\lambda)^{j-1}((T(u)-ua+vb) + (T(v)-va-ub)i) = 0.
$$
По предположению индукции из него следует, что
$$
(T_\mbC-\id\ol\lambda)^{j-1}((T(u)-ua+vb) - (T(v)-va-ub)i) = 0.
$$
Но прямое вычисление показыват, что 
$$
(T(u)-ua+vb) - (T(v)-va-ub)i = (T_\mbC-\id\ol\lambda)(u+vi).
$$
Мы получили, что $(T_\mbC-\id\ol\lambda)^{j}(u+vi) = 0$, что и требовалось.

Заменив в приведенном рассуждении
$\lambda$ на $\ol\lambda$, а $v$ на $-v$, мы получим
и обратное следствие.
\end{proof}

Важным следствием предложения~\ref{prop:conjugation-of-eigenvalue} является
тот факт, что невещественные собственные числа оператора $T_\mbC$ ходят парами.
\begin{corollary}\label{cor:eigenvalues-come-in-pairs}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор, $\lambda\in\mbC$. Число $\lambda$ является собственным числом
оператора $T_\mbC$ тогда и только тогда, когда $\ol\lambda$ является
собственным числом оператора $T_\mbC$.
\end{corollary}
\begin{proof}
Достаточно положить $j=1$ в предложении~\ref{prop:conjugation-of-eigenvalue}.
\end{proof}
Нетрудно проверить, что и кратности сопряженных собственных чисел
$\lambda$ и $\ol\lambda$ совпадают.
\begin{corollary}\label{cor:conjugate-eigenvalues-same-multiplicity}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор, $\lambda\in\mbC$~--- собственное число оператора $T_\mbC$.
Тогда кратность $\lambda$ как собственного числа $T_\mbC$ равна
кратности $\ol\lambda$ как собственного числа $T_\mbC$.
\end{corollary}
\begin{proof}
По определению кратность собственного числа~--- это размерность
соответствующего корневого подпространства.
Пусть $u_1 + v_1i,\dots,u_m+v_mi$~--- базис корневого подпространства
$V(\lambda,T_\mbC)$, где $u_1,\dots,u_m,v_1,\dots,v_m\in V$. Покажем, что
тогда векторы $u_1 - v_1i,\dots,u_m - v_mi$ образуют базис
корневого подпространства $V(\ol\lambda,T_\mbC)$.
Проверим сначала, что они лежат в этом подпространстве:
по определению корневого вектора $(T_\mbC-\id\lambda)^{\dim(V)}(u_j+v_ji) = 0$,
и по предложению~\ref{prop:conjugation-of-eigenvalue}
тогда $(T_\mbC-\id\ol\lambda)^{\dim(V)}(u_j-v_ji) = 0$.

Несложно проверить и линейную независимость векторов
$u_1-v_1i,\dots,u_m-v_mi$: 
если $(u_1-v_1i)\mu_1 + \dots + (u_m-v_mi)\mu_m = 0$,
то прямые вычисления показывают, что
$(u_1+v_1i)\ol{\mu_1} + \dots + (u_m+v_mi)\ol{\mu_m} = 0$,
и потому все коэффициенты $\mu_1,\dots,\mu_m$ равны нулю.

Наконец, нужно проверить, что это система образующих корневого
подпространства $V(\ol\lambda,T_\mbC)$. Пусть $u+vi\in V(\ol\lambda,T_\mbC)$.
Тогда (снова по предложению~\ref{prop:conjugation-of-eigenvalue})
$u-vi\in V(\lambda,T_\mbC)$. Значит, $u-vi$ является линейной комбинацией
векторов $u_1+v_1i,\dots,u_m+v_mi$:
$$
u-vi = (u_1+v_1i)\mu_1 + \dots + (u_m+v_mi)\mu_m.
$$
Но тогда $u+vi$ является линейной комбинацией
векторов $u_1-v_1i,\dots,u_m-v_mi$:
$$
u+vi = (u_1-v_1i)\ol{\mu_1} + \dots + (u_m-v_mi)\ol{\mu_m}.
$$
\end{proof}

Приведем еще один вариант переноса
предложения~\ref{prop:operator-has-an-eigenvalue} на случай
вещественных пространств.
\begin{proposition}
У линейного оператора на пространстве нечетной размерности над $\mbR$
есть собственное число.
\end{proposition}
\begin{proof}
Пусть $V$~--- векторное пространство над $\mbR$ нечетной размерности,
$T\colon V\to V$~--- линейный оператор.
По следствию~\ref{cor:conjugate-eigenvalues-same-multiplicity}
невещественные собственные числа оператора $T_\mbC$ встречаются с одинаковой
кратностью. Поэтому сумма кратностей всех невещественных собственных чисел
оператора $T_\mbC$ четна. С другой стороны, сумма кратностей
всех собственных чисел оператора $T_\mbC$ равна размерности
пространства $V_\mbC$ (по теореме~\ref{cor:sum-of-multiplicities}), и потому
равна размерности пространства $V$
(по следствию~\ref{cor:complexification-dimension}), то есть, нечетна.
Поэтому у $T_\mbC$ есть вещественное собственное число,
и по предложению~\ref{prop:complexification-real-eigenvalues}
оно является собственным числом оператора $T$.
\end{proof}

\subsection{Вещественная жорданова форма}

Введем понятие характеристического многочлена вещественного оператора.
Для этого нам понадобится следующее предложение.
\begin{proposition}\label{prop:complexification-char-poly-is-real}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор. Тогда все коэффициенты характеристического многочлена
оператора $T_\mbC$ вещественны.
\end{proposition}
\begin{proof}
Пусть $\lambda$~--- невещественное собственное число оператора $T_\mbC$,
имеющее кратность $m$. По
следствию~\ref{cor:conjugate-eigenvalues-same-multiplicity} число
$\ol\lambda$ также является собственным числом оператора $T_\mbC$
кратности $m$. Поэтому в характеристическом многочлене оператора
$T_\mbC$ присутствуют множители $(x-\lambda)^m$ и
$(x-\ol\lambda)^m$. Перемножая эти два множителя,
получаем
$$
(x-\lambda)^m(x-\ol\lambda)^m = ((x-\lambda)(x-\ol\lambda))^m
=(x^2-(\lambda+\ol\lambda)x+\lambda\ol\lambda)^m.
$$
Мы получили многочлен с вещественными коэффициентами,
поскольку $\lambda+\ol\lambda = 2\Ree(\lambda)$ и
$\lambda\ol\lambda=|\lambda|^2$.
Характеристический многочлен оператора $T_\mbC$ является произведением
пар скобок указанного вида и скобок вида $(x-t)^d$ для вещественных
собственных чисел $t$ оператора $T_\mbC$ кратности $d$.
Поэтому в произведении получаем многочлен с вещественными коэффициентами.
\end{proof}
\begin{definition}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор. \dfn{Характеристическим многочленом} оператора $T$
называется характеристический многочлен оператора $T_\mbC$.
\end{definition}

С таким определением совсем несложно доказать аналог
предложения~\ref{prop:degree-and-roots-of-char-poly}.
\begin{proposition}
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор. Тогда характеристический многочлен $T$ лежит в $\mbR[x]$,
его степень равна $\dim V$, а его корни~--- это в точности все
вещественные собственные числа оператора $T$.
\end{proposition}
\begin{proof}
Характеристический многочлен лежит в $\mbR[x]$ по
предложению~\ref{prop:complexification-char-poly-is-real},
имеет степень $\dim V$ по предложению~\ref{prop:degree-and-roots-of-char-poly}
и следствию~\ref{cor:complexification-dimension},
и имеет нужные корни по предложению~\ref{prop:degree-and-roots-of-char-poly}
и предложению~\ref{prop:complexification-real-eigenvalues}.
\end{proof}
Несложно получить и аналог теоремы Гамильтона--Кэли~\ref{thm:cayley-hamilton}.
\begin{theorem}[Гамильтона--Кэли]
Пусть $V$~--- векторное пространство над $\mbR$, $T\colon V\to V$~--- линейный
оператор. Пусть $q$~--- характеристический многочлен оператора $T$.
Тогда $q(T) = 0$.
\end{theorem}
\begin{proof}
По теореме~\ref{thm:cayley-hamilton} имеем $q(T_\mbC)=0$,
откуда следует, что $q(T)=0$ (см. рассуждение в начале
доказательства предложения~\ref{prop:minimal-poly-of-complexification}).
\end{proof}

Теперь мы готовы сформулировать аналог теоремы о жордановой форме
для вещественных операторов.

\begin{definition}
\dfn{Вещественным жордановым блоком} называется
матрица вида
$$
J_n(c)=
\begin{pmatrix}
c & 1 & 0 & \dots & 0 & 0 \\
0 & c & 1 & \dots & 0 & 0 \\
0 & 0 & c & \dots & 0 & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & 0 & \dots & c & 1 \\
0 & 0 & 0 & \dots & 0 & c
\end{pmatrix}
$$
размера $n\times n$, где $c\in\mbR$, или матрица вида
$$
J_n(\lambda)=
\begin{pmatrix}
 a & b &  1 & 0 &  0 & 0 & \dots & 0 & 0\\
-b & a &  0 & 1 &  0 & 0 & \dots & 0 & 0\\
 0 & 0 &  a & b &  1 & 0 & \dots & 0 & 0\\
 0 & 0 & -b & a &  0 & 1 & \dots & 0 & 0\\
 0 & 0 &  0 & 0 &  a & b & \dots & 0 & 0\\
 0 & 0 &  0 & 0 & -b & a & \dots & 0 & 0\\
\vdots&\vdots&\vdots&\vdots&\vdots&\vdots&\ddots&\vdots&\vdots\\
 0 & 0 &  0 & 0 &  0 & 0 & \dots & a & b\\
 0 & 0 &  0 & 0 &  0 & 0 & \dots & -b & a
\end{pmatrix}
$$
размера $(2n)\times(2n)$, где $\lambda = a+bi$, $a,b\in\mbR$, причем $b>0$.
Блочно-диагональная матрица, в которой каждый блок является
вещественным жордановым блоком,
называется \dfn{вещественной жордановой матрицей}.
Пусть $V$~--- векторное пространство над $\mbR$,
$T\colon V\to V$~--- линейный оператор. Базис пространства $V$ называется
\dfn{вещественным жордановым базисом} для оператора $T$, если матрица
$T$ в этом базисе является вещественной жордановой. Эта матрица
тогда называется \dfn{вещественной жордановой формой} оператора $T$.
\end{definition}

\begin{theorem}
Пусть $V$~--- конечномерное векторное
пространство над $\mbR$, $T$~--- линейный оператор на $V$. Тогда
в $V$ существует вещественный жорданов базис для $T$. Более того,
вещественная жорданова форма оператора $T$ единственна с точностью до
перестановки вещественных жордановых блоков.
\end{theorem}
\begin{proof}[Набросок доказательства]
Поясним, откуда берутся вещественные жордановы блоки вида $J_n(\lambda)$
для комлпексных чисел $\lambda=a+bi$, $b\neq 0$.
Рассмотрим комплексификацию $T_\mbC$ оператора $T$. Мы знаем, что
в $V_\mbC$ существует базис, в котором матрица оператора $T_\mbC$
имеет жорданов вид.
Теперь мы хотим перейти от этого базиса к базису пространства $V$
так, чтобы матрица оператора $T$ в нем выглядела не очень отлично
от матрицы $T_\mbC$ в жордановом базисе.

Пусть $\lambda$~--- невещественное собственное число оператора $T_\mbC$,
$\lambda=a+bi$. Мы выяснили, что тогда и $\ol\lambda$ является
собственным числом оператора $T_\mbC$.
Поменяв при необходимости $\lambda$ и $\ol\lambda$ местами,
можем считать, что $b > 0$.
Оказывается, тогда и все размеры жордановых блоков, соответствующих числам
$\lambda$ и $\ol\lambda$, совпадают. Действительно,
в доказательстве теоремы~\ref{thm:jordan-form} мы выразили эти
размеры блоков через размерности операторов вида
$(T_\mbC - \id\lambda)^j$. Рассуждение, аналогичное
доказательству следствия~\ref{cor:conjugate-eigenvalues-same-multiplicity},
показывает, что эти размерности для чисел $\lambda$ и $\ol\lambda$,
совпадают; поэтому и размеры блоков совпадают.

Более того, рассмотрим какой-нибудь жорданов блок вида $J_m(\lambda)$.
Пусть $u_1+v_1i,\dots,u_m+v_mi$~--- соответствующие базисные векторы.
Тогда векторы $u_1 - v_1i,\dots,u_m - v_mi$ линейно независимы,
порождают $T_\mbC$-инвариантное подпространство и в ограничении на это
подпространство получаем жорданов блок вида $J_m(\ol\lambda)$.
Таким образом, жордановы блоки, соответствующие невещественным
собственным числам оператора $T_\mbC$, разбиваются
на <<сопряженные>> пары.
Посмотрим на подпространство в $V$, порожденное векторами
$u_1,v_1,\dots,u_m,v_m$. Мы утверждаем, что эти векторы линейно
независимы, и матрица оператора $T$, ограниченного на это
подпространство, как раз равна вещественному жордановому блоку
вида $J_m(\lambda)$.

Действительно, например, мы знаем, что $T_\mbC(u_1+v_1i) = (u_1+v_1i)(a+bi)$
Раскрывая скобки, получаем, что
$T(u_1)=u_1a-v_1b$ и $T(v_1) = u_1b+v_1a$. Это объясняет
первые два столбика в матрице $J_m(\lambda)$.
Далее, $T_\mbC(u_2+v_2i) = (u_2+v_2i)(a+bi) + (u_1+v_1i)$.
Раскрывая скобки, получаем, что
$T(u_2) = u_2a-v_2b+u_1$ и $T(v_2) = u_2b+v_2a+v_1$.
Это объясняет третий и четвертый столбики в матрице $J_m(\lambda)$,
и так далее.

Таким образом, можно взять пару комплексных жордановых блоков
вида $J_m(\lambda)$ и $J_m(\ol\lambda)$ и, слегка поменяв базис
в соответствующем пространстве размерности $2m$, получить
вещественный базис, в котором эти блоки <<склеятся>> и превратятся
в один вещественный жорданов блок $J_m(\lambda)$ размера $2m$.
Осталось аккуратно разобраться с вещественными собственными числами:
показать, что можно выбрать базис в корневом подпространстве
вида $V(c,T_\mbC)$ для $c\in\mbR$ так, что он будет базисом в $V$, в котором
матрица [ограничения] оператора $T$ будет вещественным жордановым
блоком вида $J_m(c)$.
\end{proof}
